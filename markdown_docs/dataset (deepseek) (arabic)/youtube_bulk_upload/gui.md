## ClassDef YouTubeBulkUploaderGUI
**YouTubeBulkUploaderGUI**: وظيفة YouTubeBulkUploaderGUI هي توفير واجهة مستخدم رسومية (GUI) لإدارة عملية تحميل مقاطع الفيديو بشكل جماعي إلى YouTube مع إمكانية تخصيص البيانات الوصفية لكل مقطع.

**attributes**: السمات الخاصة بهذا الكلاس.
· `gui_root`: كائن Tkinter الذي يمثل النافذة الرئيسية للواجهة الرسومية.
· `logger`: كائن Logger يستخدم لتسجيل الأحداث والرسائل أثناء تشغيل التطبيق.
· `bundle_dir`: المسار إلى الدليل الذي يحتوي على ملفات التطبيق، سواء كان يعمل من خلال PyInstaller أو من خلال الكود المصدري.
· `running_in_pyinstaller`: قيمة منطقية تشير إلى ما إذا كان التطبيق يعمل من خلال PyInstaller أم لا.
· `log_level`: مستوى تسجيل الأحداث (Log Level) الذي يتم تعيينه بناءً على إدخال المستخدم.
· `log_level_var`: متغير Tkinter StringVar لتخزين مستوى التسجيل المحدد من قبل المستخدم.
· `upload_thread`: مؤشر إلى Thread الذي يتم استخدامه لتشغيل عملية التحميل بشكل غير متزامن.
· `stop_event`: كائن threading.Event يستخدم لإيقاف عملية التحميل عند الطلب.
· `dry_run_var`: متغير Tkinter BooleanVar لتحديد ما إذا كان التطبيق يعمل في وضع "التجربة الجافة" (Dry Run) أم لا.
· `noninteractive_var`: متغير Tkinter BooleanVar لتحديد ما إذا كان التطبيق يعمل في وضع غير تفاعلي (Non-interactive) أم لا.
· `source_directory_var`: متغير Tkinter StringVar لتخزين المسار إلى الدليل الذي يحتوي على ملفات الفيديو.
· `yt_client_secrets_file_var`: متغير Tkinter StringVar لتخزين مسار ملف أسرار العميل الخاص بـ YouTube API.
· `upload_batch_limit_var`: متغير Tkinter IntVar لتخزين الحد الأقصى لعدد مقاطع الفيديو التي يمكن تحميلها في الدفعة الواحدة.
· `input_file_extensions_var`: متغير Tkinter StringVar لتخزين امتدادات ملفات الفيديو التي سيتم تحميلها.
· `yt_category_id_var`: متغير Tkinter StringVar لتخزين معرف الفئة التي سيتم تحميل مقاطع الفيديو تحتها على YouTube.
· `yt_keywords_var`: متغير Tkinter StringVar لتخزين الكلمات المفتاحية التي سيتم إضافتها إلى بيانات الفيديو الوصفية.
· `yt_desc_template_file_var`: متغير Tkinter StringVar لتخزين مسار ملف القالب المستخدم لإنشاء أوصاف مقاطع الفيديو.
· `yt_title_prefix_var`: متغير Tkinter StringVar لتخزين البادئة التي سيتم إضافتها إلى عناوين مقاطع الفيديو.
· `yt_title_suffix_var`: متغير Tkinter StringVar لتخزين اللاحقة التي سيتم إضافتها إلى عناوين مقاطع الفيديو.
· `thumb_file_prefix_var`: متغير Tkinter StringVar لتخزين البادئة التي سيتم استخدامها لمطابقة أسماء ملفات الصور المصغرة.
· `thumb_file_suffix_var`: متغير Tkinter StringVar لتخزين اللاحقة التي سيتم استخدامها لمطابقة أسماء ملفات الصور المصغرة.
· `thumb_file_extensions_var`: متغير Tkinter StringVar لتخزين امتدادات ملفات الصور المصغرة المسموح بها.
· `privacy_status_var`: متغير Tkinter StringVar لتخزين حالة الخصوصية لمقاطع الفيديو التي سيتم تحميلها (عامة، خاصة، غير مدرجة).
· `dont_show_welcome_message_var`: متغير Tkinter BooleanVar لتحديد ما إذا كان سيتم عرض رسالة الترحيب عند بدء التشغيل أم لا.
· `check_duplicate_titles_var`: متغير Tkinter BooleanVar لتحديد ما إذا كان سيتم التحقق من العناوين المكررة قبل التحميل أم لا.

**Code Description**:  
YouTubeBulkUploaderGUI هو كلاس يعمل كواجهة مستخدم رسومية (GUI) لتطبيق تحميل مقاطع الفيديو بشكل جماعي إلى YouTube. يتم استخدامه لإدارة الإعدادات المختلفة المتعلقة بعملية التحميل، مثل تحديد الدليل الذي يحتوي على ملفات الفيديو، واختيار ملف أسرار العميل الخاص بـ YouTube API، وتعيين البيانات الوصفية مثل العناوين والأوصاف والكلمات المفتاحية. كما يوفر الكلاس إمكانية تشغيل التطبيق في وضع "التجربة الجافة" (Dry Run) حيث يتم تسجيل الإجراءات دون تنفيذها فعليًا على YouTube.

يتم إنشاء الكلاس باستخدام مكتبة Tkinter لبناء الواجهة الرسومية، ويتم تسجيل الأحداث والرسائل باستخدام مكتبة logging. يتم تخزين الإعدادات المختلفة في متغيرات Tkinter (مثل StringVar و BooleanVar) والتي يتم تحديثها بناءً على إدخال المستخدم. كما يتم استخدام threading لتشغيل عملية التحميل في خيط منفصل لمنع تجميد الواجهة الرسومية أثناء التحميل.

يتم استدعاء هذا الكلاس من خلال الدالة `main()` في نفس الملف، حيث يتم تهيئة الكلاس مع تمرير الكائنات الضرورية مثل `gui_root` و `logger` و `bundle_dir`. يتم بعد ذلك تشغيل الحلقة الرئيسية للواجهة الرسومية باستخدام `gui_root.mainloop()`.

**Note**:  
- يجب التأكد من وجود ملف أسرار العميل الخاص بـ YouTube API قبل بدء عملية التحميل.
- يُفضل تشغيل التطبيق في وضع "التجربة الجافة" (Dry Run) أولاً للتحقق من صحة الإعدادات قبل التحميل الفعلي.
- يمكن إيقاف عملية التحميل في أي وقت باستخدام زر "Stop" في الواجهة الرسومية.

**Output Example**:  
لا يوجد ناتج مباشر من هذا الكلاس، حيث يعمل كواجهة مستخدم رسومية. ومع ذلك، يمكن رؤية النتائج من خلال تسجيلات الأحداث (Logs) التي يتم عرضها في مربع النص المخصص في الواجهة الرسومية، أو من خلال ملف السجل (Log File) الذي يتم إنشاؤه في الدليل المحدد.
### FunctionDef __init__(self, gui_root, logger, bundle_dir, running_in_pyinstaller)
**__init__**: وظيفة `__init__` هي تهيئة الكائن `YouTubeBulkUploaderGUI` وتعيين المتغيرات الأساسية وإنشاء واجهة المستخدم الرسومية (GUI) لتطبيق تحميل الفيديوهات على YouTube بشكل مجمّع.

**parameters**: معاملات هذه الوظيفة.
· `gui_root`: كائن من نوع `tk.Tk` يمثل النافذة الرئيسية لواجهة المستخدم الرسومية.
· `logger`: كائن من نوع `logging.Logger` يستخدم لتسجيل الأحداث والرسائل.
· `bundle_dir`: كائن من نوع `Path` يمثل المسار إلى المجلد الذي يحتوي على ملفات التطبيق.
· `running_in_pyinstaller`: قيمة منطقية (`bool`) تشير إلى ما إذا كان التطبيق يعمل داخل بيئة PyInstaller أم لا.

**Code Description**: 
تقوم هذه الوظيفة بتهيئة الكائن `YouTubeBulkUploaderGUI` وتعيين المتغيرات الأساسية التي سيتم استخدامها في جميع أنحاء التطبيق. يتم تنفيذ الخطوات التالية:

1. **تعيين المتغيرات الأساسية**: يتم تعيين المتغيرات الممررة إلى الوظيفة (`gui_root`, `logger`, `bundle_dir`, `running_in_pyinstaller`) كسمات للكائن (`self.gui_root`, `self.logger`, `self.bundle_dir`, `self.running_in_pyinstaller`). يتم أيضًا تسجيل رسالة تفيد ببدء التهيئة باستخدام الـ logger.

2. **تعيين متغيرات الإدخال**: يتم إنشاء وتعيين متغيرات `tk.StringVar` و`tk.BooleanVar` و`tk.IntVar` التي ستستخدم لتخزين القيم المدخلة من واجهة المستخدم الرسومية. تشمل هذه المتغيرات:
   - `log_level_var`: لتحديد مستوى تسجيل الأحداث.
   - `dry_run_var`: لتحديد ما إذا كان التطبيق يعمل في وضع "التشغيل الجاف" (Dry Run).
   - `noninteractive_var`: لتحديد ما إذا كان التطبيق يعمل في الوضع غير التفاعلي.
   - `source_directory_var`: لتحديد المجلد الذي يحتوي على الفيديوهات المراد تحميلها.
   - `yt_client_secrets_file_var`: لتحديد ملف سر API بيانات YouTube.
   - `upload_batch_limit_var`: لتحديد الحد الأقصى لعدد الفيديوهات التي يمكن تحميلها في الدفعة الواحدة.
   - `input_file_extensions_var`: لتحديد امتدادات ملفات الفيديو المقبولة.
   - `yt_category_id_var`: لتحديد فئة الفيديو على YouTube.
   - `yt_keywords_var`: لتحديد الكلمات المفتاحية للفيديو.
   - `yt_desc_template_file_var`: لتحديد ملف قالب وصف الفيديو.
   - `yt_title_prefix_var` و`yt_title_suffix_var`: لتحديد البادئة واللاحقة لعنوان الفيديو.
   - `thumb_file_prefix_var` و`thumb_file_suffix_var`: لتحديد البادئة واللاحقة لاسم ملف الصورة المصغرة.
   - `thumb_file_extensions_var`: لتحديد امتدادات ملفات الصور المصغرة المقبولة.
   - `privacy_status_var`: لتحديد حالة الخصوصية للفيديو (عام، خاص، غير مدرج).
   - `dont_show_welcome_message_var`: لتحديد ما إذا كان يجب إظهار الرسالة الترحيبية أم لا.
   - `check_duplicate_titles_var`: لتحديد ما إذا كان يجب التحقق من العناوين المكررة.

3. **تعيين وظيفة الإغلاق**: يتم تعيين وظيفة `on_closing` كدالة رد اتصال (callback) عند محاولة إغلاق النافذة الرئيسية باستخدام `wm_protocol`.

4. **تعيين أيقونة النافذة**: يتم استدعاء وظيفة `set_window_icon` لتعيين أيقونة النافذة الرئيسية.

5. **إنشاء واجهة المستخدم الرسومية**: يتم استدعاء وظيفة `create_gui_frames_widgets` لإنشاء الإطارات والعناصر الرسومية في واجهة المستخدم.

6. **إضافة معالج النص للسجل**: يتم استدعاء وظيفة `add_textbox_log_handler` لإضافة معالج لتسجيل الرسائل في واجهة المستخدم الرسومية.

7. **تحميل إعدادات واجهة المستخدم**: يتم استدعاء وظيفة `load_gui_config_options` لتحميل الإعدادات المحفوظة من ملف التكوين.

8. **عرض الرسالة الترحيبية**: يتم استدعاء وظيفة `show_welcome_popup` لعرض الرسالة الترحيبية إذا لم يحدد المستخدم خيار إخفائها.

9. **تهيئة المتغيرات الإضافية**: يتم تهيئة المتغيرات `user_input_event` و`user_input_result` لإدارة الأحداث والإدخالات من المستخدم.

10. **تسجيل رسالة التهيئة الناجحة**: يتم تسجيل رسالة تفيد بأن التهيئة قد اكتملت بنجاح باستخدام الـ logger.

**Note**: 
- يجب التأكد من أن جميع المتغيرات المرتبطة بواجهة المستخدم الرسومية (`tk.StringVar`, `tk.BooleanVar`, `tk.IntVar`) قد تم تهيئتها بشكل صحيح قبل استخدامها.
- يتم استدعاء عدة وظائف داخل `__init__` لتهيئة واجهة المستخدم الرسومية بشكل كامل، بما في ذلك `set_window_icon`, `create_gui_frames_widgets`, `add_textbox_log_handler`, `load_gui_config_options`, و`show_welcome_popup`.
- يتم استخدام `self.stop_event` لإدارة عملية إيقاف التحميل عند إغلاق النافذة.
***
### FunctionDef show_welcome_popup(self)
**show_welcome_popup**: وظيفة show_welcome_popup هي عرض نافذة ترحيبية للمستخدم عند بدء تشغيل التطبيق، تحتوي على معلومات حول كيفية استخدام الأداة وخيارات إضافية مثل مشاهدة فيديو تعليمي أو إخفاء هذه النافذة في المستقبل.

**parameters**: لا تحتوي هذه الوظيفة على معاملات مباشرة، ولكنها تعتمد على متغيرات داخلية مثل `self.dont_show_welcome_message_var` لتحديد ما إذا كان يجب عرض النافذة الترحيبية أم لا.

**Code Description**: 
تقوم هذه الوظيفة بإنشاء نافذة فرعية (Toplevel) تظهر عند بدء تشغيل التطبيق، وذلك إذا لم يحدد المستخدم خيار "عدم إظهار هذه الرسالة مرة أخرى" من خلال المتغير `self.dont_show_welcome_message_var`. تحتوي النافذة الترحيبية على رسالة ترحيبية طويلة توضح كيفية استخدام أداة YouTube Bulk Uploader، بما في ذلك الحاجة إلى ملف JSON لسر API بيانات YouTube، وكيفية تحميل الفيديوهات بشكل جماعي، واستخدام قوالب للعناوين والوصف، وخيارات أخرى مثل "التشغيل الجاف" (Dry Run) و"الوضع غير التفاعلي" (Non-interactive).

تحتوي النافذة أيضًا على زر "Watch Tutorial" يقوم بفتح رابط فيديو تعليمي على YouTube باستخدام وظيفة `open_link`، وزر "Close" لإغلاق النافذة. بالإضافة إلى ذلك، يوجد خيار "Don't show this message again" الذي يسمح للمستخدم بتحديد عدم إظهار هذه النافذة في المستقبل.

يتم حساب حجم النافذة وموقعها لتظهر في وسط النافذة الرئيسية للتطبيق باستخدام الدوال `winfo_width` و`winfo_height` و`winfo_x` و`winfo_y` لتحديد الإحداثيات المناسبة.

**Note**: 
- يتم التحقق من قيمة `self.dont_show_welcome_message_var` قبل عرض النافذة، فإذا كانت القيمة `True`، لن يتم عرض النافذة الترحيبية.
- يتم تمرير رابط ثابت "https://youtu.be/9WklrdupZhg" إلى وظيفة `open_link` عند النقر على زر "Watch Tutorial".
- يتم تحديث النافذة لحساب حجمها قبل تحديد موقعها في وسط النافذة الرئيسية.

**Output Example**: لا تحتوي هذه الوظيفة على قيمة إرجاع، ولكنها تعرض نافذة رسائل تحتوي على نص ترحيبي وأزرار تفاعلية.
***
### FunctionDef open_link(self, url)
**open_link**: وظيفة open_link هي فتح رابط URL في متصفح الويب الافتراضي.

**parameters**: معاملات هذه الوظيفة.
· url: الرابط الذي سيتم فتحه في المتصفح. يجب أن يكون هذا المعامل من نوع سلسلة نصية (string) ويحتوي على عنوان URL صالح.

**Code Description**: 
تقوم هذه الوظيفة بفتح رابط URL معين في متصفح الويب الافتراضي للمستخدم. يتم ذلك باستخدام الوحدة `webbrowser` المدمجة في لغة Python، والتي توفر واجهة بسيطة لفتح صفحات الويب. عند استدعاء الوظيفة، يتم تمرير الرابط المطلوب كمعامل `url`، ثم يتم استخدام الدالة `webbrowser.open(url)` لفتح هذا الرابط في المتصفح.

في سياق المشروع، يتم استدعاء هذه الوظيفة من خلال وظيفة أخرى تسمى `show_welcome_popup`، والتي تعرض نافذة ترحيبية للمستخدم عند بدء تشغيل التطبيق. تحتوي هذه النافذة على زر "Watch Tutorial" الذي يقوم بفتح رابط فيديو تعليمي على YouTube عند النقر عليه. يتم تمرير الرابط الثابت "https://youtu.be/9WklrdupZhg" كمعامل إلى `open_link`، مما يسمح للمستخدم بمشاهدة الفيديو التعليمي مباشرة في المتصفح.

**Note**: 
- يجب التأكد من أن الرابط الممرر إلى الوظيفة صالح ومباشر (يبدأ بـ "http://" أو "https://") حتى يعمل بشكل صحيح.
- يعتمد سلوك فتح الرابط على المتصفح الافتراضي المحدد في نظام المستخدم. إذا لم يكن هناك متصفح افتراضي معين، فقد لا تعمل الوظيفة كما هو متوقع.
***
### FunctionDef load_gui_config_options(self)
Doc is waiting to be generated...
***
### FunctionDef save_gui_config_options(self)
**save_gui_config_options**: وظيفة `save_gui_config_options` هي حفظ إعدادات واجهة المستخدم الرسومية (GUI) في ملف تكوين (config file) لتخزين القيم المدخلة من قبل المستخدم.

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters) حيث تعتمد فقط على البيانات المخزنة في المتغيرات الخاصة بالكائن (`self`).

**Code Description**: 
تقوم هذه الدالة بحفظ جميع الإعدادات والقيم المدخلة من خلال واجهة المستخدم الرسومية في ملف تكوين (config file) بتنسيق JSON. يتم ذلك من خلال الخطوات التالية:

1. **تسجيل العملية**: يتم تسجيل بدء عملية الحفظ في ملف السجلات (log) باستخدام `self.logger.info`، حيث يتم طباعة مسار ملف التكوين (`self.gui_config_filepath`) الذي سيتم حفظ الإعدادات فيه.

2. **استخراج أنماط الاستبدال**: يتم استدعاء الدالة `get_replacements` من ثلاث إطارات مختلفة (`self.youtube_desc_frame`, `self.youtube_title_frame`, `self.thumbnail_frame`) لاستخراج أنماط الاستبدال المدخلة من قبل المستخدم. هذه الأنماط تستخدم لتعديل أوصاف الفيديوهات، عناوين الفيديوهات، وأسماء ملفات الصور المصغرة (thumbnails).

3. **إنشاء كائن التكوين**: يتم إنشاء كائن `config` يحتوي على جميع القيم المدخلة من واجهة المستخدم، بما في ذلك:
   - مستوى التسجيل (`log_level`).
   - وضع التجربة الجافة (`dry_run`).
   - الوضع غير التفاعلي (`noninteractive`).
   - دليل المصدر (`source_directory`).
   - ملف أسرار عميل YouTube (`yt_client_secrets_file`).
   - امتدادات ملفات الإدخال (`input_file_extensions`).
   - حد تحميل الدفعات (`upload_batch_limit`).
   - فئة YouTube (`yt_category_id`).
   - الكلمات المفتاحية (`yt_keywords`).
   - ملف قالب وصف YouTube (`yt_desc_template_file`).
   - بادئة عنوان YouTube (`yt_title_prefix`).
   - لاحقة عنوان YouTube (`yt_title_suffix`).
   - بادئة ملف الصورة المصغرة (`thumb_file_prefix`).
   - لاحقة ملف الصورة المصغرة (`thumb_file_suffix`).
   - امتدادات ملفات الصور المصغرة (`thumb_file_extensions`).
   - حالة الخصوصية (`privacy_status`).
   - أنماط استبدال وصف YouTube (`youtube_description_replacements`).
   - أنماط استبدال عنوان YouTube (`youtube_title_replacements`).
   - أنماط استبدال أسماء ملفات الصور المصغرة (`thumbnail_filename_replacements`).
   - إخفاء رسالة الترحيب (`dont_show_welcome_message`).
   - التحقق من العناوين المكررة (`check_duplicate_titles`).

4. **حفظ التكوين في ملف**: يتم فتح ملف التكوين (`self.gui_config_filepath`) للكتابة، ثم يتم استخدام الدالة `json.dump` لحفظ كائن `config` في الملف بتنسيق JSON مع مسافات بادئة (indent=4) لتحسين قابلية القراءة.

**العلاقة مع الدوال الأخرى**:
- يتم استدعاء هذه الدالة من خلال الدالة `on_closing` عند إغلاق واجهة المستخدم الرسومية. حيث يتم حفظ الإعدادات قبل تدمير النافذة لضمان عدم فقدان التغييرات التي أدخلها المستخدم.
- تعتمد هذه الدالة على الدالة `get_replacements` لاستخراج أنماط الاستبدال من الإطارات المختلفة (`youtube_desc_frame`, `youtube_title_frame`, `thumbnail_frame`).

**Note**: 
- يجب التأكد من أن جميع القيم المدخلة في واجهة المستخدم صحيحة قبل حفظها، حيث سيتم تخزينها كما هي في ملف التكوين.
- يتم حفظ الملف بتنسيق JSON، مما يسهل قراءته وتعديله يدويًا إذا لزم الأمر.
- في حالة وجود أخطاء في تنسيق أنماط الاستبدال، قد تؤدي إلى أخطاء أثناء عملية الحفظ أو التحميل لاحقًا.
***
### FunctionDef on_log_level_change(self)
**on_log_level_change**: وظيفة `on_log_level_change` هي تحديث مستوى تسجيل الأحداث (log level) بناءً على القيمة المحددة من واجهة المستخدم الرسومية (GUI).

**parameters**: معاملات هذه الوظيفة.
· `*args`: معامل متغير يستقبل أي عدد من الوسائط، ولكنه غير مستخدم مباشرة في الوظيفة.

**Code Description**: 
تقوم هذه الوظيفة بتحديث مستوى تسجيل الأحداث (log level) بناءً على القيمة المحددة من واجهة المستخدم الرسومية (GUI). يتم ذلك من خلال الخطوات التالية:

1. تسجيل رسالة في السجل (log) تشير إلى تغيير مستوى تسجيل الأحداث إلى القيمة الجديدة المحددة من واجهة المستخدم الرسومية باستخدام `self.logger.info`.

2. استرجاع قيمة مستوى تسجيل الأحداث من المتغير `self.log_level_var`، وهو متغير من نوع `tk.StringVar` مرتبط بعنصر واجهة المستخدم الرسومية الذي يسمح للمستخدم بتحديد مستوى تسجيل الأحداث.

3. تحويل القيمة النصية لمستوى تسجيل الأحداث إلى ثابت من وحدة `logging` باستخدام الدالة `getattr`. إذا لم يتم العثور على الثابت المطابق، يتم استخدام القيمة الافتراضية `logging.DEBUG`.

4. تحديث مستوى تسجيل الأحداث في الكائن `self.logger` باستخدام الدالة `setLevel` مع القيمة المحولة.

يتم استدعاء هذه الوظيفة تلقائيًا عند تغيير قيمة `self.log_level_var` في واجهة المستخدم الرسومية، حيث يتم تعيينها كدالة رد اتصال (callback) باستخدام `self.log_level_var.trace("w", self.on_log_level_change)` في دالة `__init__`.

**Note**: 
- تأكد من أن القيمة المحددة في `self.log_level_var` تتوافق مع أحد مستويات تسجيل الأحداث المعروفة في وحدة `logging` (مثل "DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL")، وإلا سيتم استخدام القيمة الافتراضية `logging.DEBUG`.
- هذه الوظيفة تعتمد على وجود كائن `logger` مهيأ مسبقًا في الكائن `self`، ويجب أن يكون هذا الكائن موجودًا ويعمل بشكل صحيح قبل استدعاء هذه الوظيفة.
***
### FunctionDef create_gui_frames_widgets(self)
**create_gui_frames_widgets**: وظيفة `create_gui_frames_widgets` هي إنشاء وتهيئة الإطارات والعناصر الرسومية (widgets) لواجهة المستخدم الرسومية (GUI) لتطبيق تحميل الفيديوهات على YouTube بشكل مجمّع.

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters) حيث يتم تنفيذها مباشرةً من خلال الكائن الحالي (`self`).

**Code Description**: 
تقوم هذه الوظيفة بإنشاء وتهيئة الإطارات والعناصر الرسومية (widgets) لواجهة المستخدم الرسومية (GUI) لتطبيق تحميل الفيديوهات على YouTube بشكل مجمّع. يتم تنفيذ الخطوات التالية:

1. **تعيين عنوان النافذة**: يتم تعيين عنوان النافذة الرئيسية (`self.gui_root.title`) ليشمل اسم التطبيق وإصدار الحزمة (`package_version`) الذي يتم الحصول عليه باستخدام `pkg_resources.get_distribution`.

2. **تهيئة تخطيط الشبكة (Grid Layout)**: يتم تهيئة تخطيط الشبكة للنافذة الرئيسية (`self.gui_root`) باستخدام `grid_rowconfigure` و`grid_columnconfigure` لضمان أن الإطارات يمكنها التمدد بشكل صحيح عند تغيير حجم النافذة.

3. **إنشاء إطار الخيارات العامة (General Options Frame)**: يتم إنشاء إطار `self.general_frame` باستخدام الكلاس `ReusableWidgetFrame`، ويتم وضعه في الصف الأول (`row=0`) والعمود الأول (`column=0`) من الشبكة. يتم استدعاء الدالة `add_general_options_widgets` لإضافة العناصر الرسومية الخاصة بالخيارات العامة إلى هذا الإطار.

4. **إنشاء إطار خيارات عنوان YouTube (YouTube Title Frame)**: يتم إنشاء إطار `self.youtube_title_frame` باستخدام الكلاس `ReusableWidgetFrame`، ويتم وضعه في الصف الأول (`row=0`) والعمود الثاني (`column=1`) من الشبكة. يتم استدعاء الدالة `add_youtube_title_widgets` لإضافة العناصر الرسومية الخاصة بخيارات عنوان YouTube.

5. **إنشاء إطار خيارات الصور المصغرة (Thumbnail Options Frame)**: يتم إنشاء إطار `self.thumbnail_frame` باستخدام الكلاس `ReusableWidgetFrame`، ويتم وضعه في الصف الثاني (`row=1`) والعمود الأول (`column=0`) من الشبكة. يتم استدعاء الدالة `add_thumbnail_options_widgets` لإضافة العناصر الرسومية الخاصة بخيارات الصور المصغرة.

6. **إنشاء إطار خيارات وصف YouTube (YouTube Description Frame)**: يتم إنشاء إطار `self.youtube_desc_frame` باستخدام الكلاس `ReusableWidgetFrame`، ويتم وضعه في الصف الثاني (`row=1`) والعمود الثاني (`column=1`) من الشبكة. يتم استدعاء الدالة `add_youtube_description_widgets` لإضافة العناصر الرسومية الخاصة بخيارات وصف YouTube.

7. **إنشاء إطار الأزرار (Button Frame)**: يتم إنشاء إطار `button_frame` الذي يمتد عبر عمودين من الشبكة (`columnspan=2`). يتم إضافة أربعة أزرار إلى هذا الإطار:
   - زر "Run" لبدء عملية التحميل (`self.run_button`).
   - زر "Stop" لإيقاف العملية الحالية (`self.stop_button`).
   - زر "Clear Log" لمسح محتويات نافذة السجل (`self.clear_log_button`).
   - زر "Reset YouTube Auth" لإعادة تعيين مصادقة YouTube (`self.reset_auth_button`).

8. **إضافة شريط التقدم (Progress Bar)**: يتم إضافة شريط تقدم (`self.progress_bar`) إلى إطار الأزرار، والذي يمتد عبر ثلاثة أعمدة (`columnspan=3`).

9. **إضافة نافذة السجل (Log Output)**: يتم إضافة تسمية (`log_output_label`) ونافذة نصية قابلة للتمرير (`self.log_output`) لعرض سجل العمليات في الجزء السفلي من النافذة الرئيسية.

يتم استدعاء هذه الوظيفة في الدالة `__init__` من الكلاس `YouTubeBulkUploaderGUI`، حيث يتم تهيئة واجهة المستخدم الرسومية بالكامل عند بدء تشغيل التطبيق. تعتمد هذه الوظيفة على عدة وظائف أخرى مثل `add_general_options_widgets`، `add_youtube_title_widgets`، `add_thumbnail_options_widgets`، و`add_youtube_description_widgets` لإضافة العناصر الرسومية إلى الإطارات المختلفة.

**Note**: 
- يجب التأكد من أن جميع الإطارات والعناصر الرسومية مرتبطة بشكل صحيح بالمتغيرات (`vars`) الخاصة بها لضمان تحديث القيم بشكل صحيح.
- يتم استخدام `Tooltip` لعرض نصائح مساعدة عند تحريك المؤشر فوق العناصر، مما يساعد المستخدمين على فهم وظيفة كل عنصر.
- يتم تحديث الصف (`self.row`) تلقائيًا بعد إضافة كل مجموعة من العناصر لضمان ترتيبها بشكل صحيح في الواجهة.
***
### FunctionDef add_general_options_widgets(self)
**add_general_options_widgets**: وظيفة `add_general_options_widgets` هي إضافة عناصر واجهة المستخدم (widgets) الخاصة بالإعدادات العامة لتطبيق تحميل الفيديوهات على YouTube بشكل مجمّع.

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters) حيث يتم تنفيذها مباشرةً من خلال الكائن الحالي (`self`).

**Code Description**: 
تقوم هذه الوظيفة بإنشاء وإضافة مجموعة من العناصر الرسومية (widgets) إلى إطار الإعدادات العامة (`general_frame`) في واجهة المستخدم الرسومية (GUI). هذه العناصر تسمح للمستخدم بتحديد الإعدادات العامة اللازمة لعملية تحميل الفيديوهات على YouTube. يتم تنظيم العناصر في صفوف باستخدام دالة `new_row` من الكلاس `ReusableWidgetFrame`، مما يضمن ترتيبًا منظمًا للعناصر في الواجهة.

العناصر التي يتم إضافتها تشمل:
1. **مستوى السجلات (Log Level)**: يتم إضافة عنصر `OptionMenu` يسمح للمستخدم باختيار مستوى تفصيل السجلات (info, warning, error, debug). يتم إرفاق `Tooltip` لشرح وظيفة هذا الخيار.
2. **وضع التجربة (Dry Run)**: يتم إضافة عنصر `Checkbutton` لتمكين أو تعطيل وضع التجربة، والذي يحاكي عملية التحميل دون نشر الفيديوهات فعليًا على YouTube. يتم إرفاق `Tooltip` لشرح أهمية هذا الخيار.
3. **وضع غير تفاعلي (Non-interactive)**: يتم إضافة عنصر `Checkbutton` لتمكين أو تعطيل الوضع غير التفاعلي، والذي يسمح بتشغيل العملية دون تدخل يدوي. يتم إرفاق `Tooltip` لشرح استخدام هذا الخيار.
4. **دليل المصدر (Source Directory)**: يتم إضافة عنصر `Entry` لعرض مسار الدليل الذي يحتوي على ملفات الفيديو، بالإضافة إلى زر "Browse..." لفتح نافذة حوار لتحديد الدليل. يتم استدعاء دالة `select_source_directory` عند النقر على الزر.
5. **ملف أسرار العميل (YouTube Client Secret File)**: يتم إضافة عنصر `Entry` لعرض مسار ملف أسرار العميل الخاص بـ YouTube API، بالإضافة إلى زر "Browse..." لفتح نافذة حوار لتحديد الملف. يتم استدعاء دالة `select_client_secrets_file` عند النقر على الزر.
6. **امتدادات ملفات الإدخال (Input File Extensions)**: يتم إضافة عنصر `Entry` لتحديد امتدادات ملفات الفيديو التي سيتم تحميلها.
7. **حد الدفعة (Upload Batch Limit)**: يتم إضافة عنصر `Entry` لتحديد الحد الأقصى لعدد الفيديوهات التي يمكن تحميلها في دفعة واحدة.
8. **معرف فئة YouTube (YouTube Category ID)**: يتم إضافة عنصر `Entry` لتحديد معرف الفئة التي سيتم تحميل الفيديوهات تحتها على YouTube.
9. **الكلمات المفتاحية (YouTube Keywords)**: يتم إضافة عنصر `Entry` لتحديد الكلمات المفتاحية التي سيتم إضافتها إلى وصف الفيديو.
10. **حالة الخصوصية (Privacy Status)**: يتم إضافة عنصر `OptionMenu` يسمح للمستخدم باختيار حالة الخصوصية للفيديوهات (public, private, unlisted) باستخدام قيم من الكلاس `VideoPrivacyStatus`.
11. **فحص العناوين المكررة (Check for Duplicate Titles)**: يتم إضافة عنصر `Checkbutton` لتمكين أو تعطيل فحص العناوين المكررة قبل التحميل.

يتم استدعاء هذه الوظيفة من خلال دالة `create_gui_frames_widgets`، حيث يتم إنشاء إطار الإعدادات العامة (`general_frame`) وإضافة العناصر إليه. هذه الوظيفة تعتبر جزءًا أساسيًا من عملية إعداد واجهة المستخدم الرسومية للتطبيق.

**Note**: 
- يجب التأكد من أن جميع العناصر مرتبطة بشكل صحيح بالمتغيرات (`vars`) الخاصة بها لضمان تحديث القيم بشكل صحيح.
- يتم استخدام `Tooltip` لعرض نصائح مساعدة عند تحريك المؤشر فوق العناصر، مما يساعد المستخدمين على فهم وظيفة كل عنصر.
- يتم تنظيم العناصر في صفوف باستخدام دالة `new_row`، مما يضمن ترتيبًا منظمًا للواجهة.
***
### FunctionDef add_youtube_title_widgets(self)
**add_youtube_title_widgets**: وظيفة `add_youtube_title_widgets` هي إضافة واجهة مستخدم تسمح للمستخدم بتعيين البادئة (prefix) واللاحقة (suffix) لعناوين فيديوهات YouTube، بالإضافة إلى إدارة أنماط البحث والاستبدال للنصوص في العناوين.

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters).

**Code Description**: تقوم هذه الدالة بإنشاء واجهة مستخدم داخل إطار `self.youtube_title_frame` لإدارة عناوين فيديوهات YouTube. يتم تنفيذ الخطوات التالية:

1. يتم إنشاء تسمية (label) بعنوان "Prefix:" باستخدام `tk.Label`، ويتم وضعها في الصف الحالي (`frame.row`) والعمود الأول. يتم إرفاق نافذة تلميحية (tooltip) باستخدام الكلاس `Tooltip` لتوضيح أن البادئة تُضاف إلى بداية اسم ملف الفيديو لإنشاء عنوان YouTube المفضل.

2. يتم إنشاء حقل إدخال (Entry) باستخدام `tk.Entry`، حيث يتم ربطه بمتغير النص `self.yt_title_prefix_var`. يتم وضع هذا الحقل في نفس الصف ولكن في العمود الثاني، مع توسيعه ليمتد أفقيًا (sticky="ew"). يتم إرفاق نافذة تلميحية لتوضيح كيفية إدخال النص في هذا الحقل.

3. يتم استدعاء الدالة `new_row` من الكائن `self.youtube_title_frame` لإضافة صف جديد في الإطار، مما يسمح بوضع العناصر التالية في صف منفصل.

4. يتم إنشاء تسمية أخرى بعنوان "Suffix:"، ويتم وضعها في الصف الجديد والعمود الأول. يتم إرفاق نافذة تلميحية لتوضيح أن اللاحقة تُضاف إلى نهاية اسم ملف الفيديو لإنشاء عنوان YouTube المفضل.

5. يتم إنشاء حقل إدخال آخر مرتبط بمتغير النص `self.yt_title_suffix_var`، ويتم وضعه في نفس الصف ولكن في العمود الثاني. يتم إرفاق نافذة تلميحية لتوضيح كيفية إدخال النص في هذا الحقل.

6. يتم استدعاء الدالة `new_row` مرة أخرى لإضافة صف جديد.

7. أخيرًا، يتم استدعاء الدالة `add_find_replace_widgets` من الكائن `self.youtube_title_frame` لإضافة واجهة مستخدم تسمح للمستخدم بتعيين أنماط البحث والاستبدال للنصوص في عناوين الفيديوهات. يتم تمرير نص التسمية "Find / Replace Patterns:" ونص التلميح الذي يشرح الغرض من هذه الواجهة.

ترتبط هذه الدالة بشكل وثيق بوظيفة `create_gui_frames_widgets`، حيث يتم استدعاؤها لإنشاء واجهة مستخدم خاصة بإدارة عناوين فيديوهات YouTube. كما أنها تعتمد على وظائف أخرى مثل `new_row` و`add_find_replace_widgets` لتنظيم العناصر في الواجهة الرسومية.

**Note**: 
- يجب التأكد من أن المتغيرات `self.yt_title_prefix_var` و`self.yt_title_suffix_var` تم تهيئتها بشكل صحيح قبل استخدام هذه الدالة.
- يمكن استخدام التعبيرات النمطية (regex) في واجهة البحث والاستبدال لإجراء عمليات متقدمة على النصوص.
- يتم تحديث الصفوف تلقائيًا بعد كل إضافة لعنصر جديد في الواجهة.
***
### FunctionDef add_youtube_description_widgets(self)
**add_youtube_description_widgets**: وظيفة `add_youtube_description_widgets` هي إضافة واجهة مستخدم لإدارة خيارات وصف فيديوهات YouTube، بما في ذلك تحديد ملف قالب الوصف وإضافة أنماط البحث والاستبدال للنصوص.

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters).

**Code Description**: تقوم هذه الدالة بإنشاء واجهة مستخدم داخل إطار `youtube_desc_frame` لإدارة خيارات وصف فيديوهات YouTube. يتم تنفيذ الخطوات التالية:

1. يتم إنشاء تسمية (Label) بعنوان "Template File:" لتوضيح أن المستخدم يحتاج إلى تحديد ملف قالب لوصف الفيديوهات. يتم وضع هذه التسمية في الصف الحالي (`frame.row`) والعمود الأول من الإطار. يتم إرفاق نافذة تلميحية (Tooltip) لتوضيح أن هذا الحقل يستخدم لتحديد مسار ملف القالب.

2. يتم إنشاء حقل إدخال (Entry) لعرض مسار ملف القالب المحدد. يتم ربط هذا الحقل بمتغير `yt_desc_template_file_var`، ويتم تعيين حالة الحقل إلى "readonly" لمنع المستخدم من تعديله يدويًا. يتم وضع هذا الحقل في نفس الصف والعمود الثاني من الإطار. يتم إرفاق نافذة تلميحية لتوضيح أن هذا الحقل يعرض مسار الملف المحدد وأنه غير قابل للتعديل.

3. يتم إنشاء زر "Browse..." لفتح نافذة حوار تسمح للمستخدم بتحديد ملف القالب. يتم ربط هذا الزر بالدالة `select_yt_desc_template_file`، والتي تفتح نافذة حوار لاختيار الملف. يتم وضع الزر في نفس الصف والعمود الثالث من الإطار. يتم إرفاق نافذة تلميحية لتوضيح أن هذا الزر يفتح نافذة حوار لتحديد ملف القالب.

4. يتم استدعاء الدالة `new_row` لإضافة صف جديد في الإطار، مما يسمح بترتيب العناصر التالية في صف جديد.

5. يتم استدعاء الدالة `add_find_replace_widgets` من إطار `youtube_desc_frame` لإضافة واجهة مستخدم لإدارة أنماط البحث والاستبدال للنصوص. يتم تمرير نص التسمية "Find / Replace Patterns:" ونص توضيحي يشرح كيفية استخدام هذه الواجهة، بما في ذلك إمكانية استخدام `{{youtube_title}}` لحقن عنوان الفيديو في النص المستبدل.

ترتبط هذه الدالة بالدالة `select_yt_desc_template_file`، والتي يتم استدعاؤها عند النقر على زر "Browse..." لفتح نافذة حوار لتحديد ملف القالب. كما ترتبط بالدالة `add_find_replace_widgets`، والتي تضيف واجهة مستخدم لإدارة أنماط البحث والاستبدال.

يتم استدعاء هذه الدالة في الدالة `create_gui_frames_widgets`، حيث يتم إنشاء إطار `youtube_desc_frame` وإضافة العناصر اللازمة لإدارة وصف فيديوهات YouTube.

**Note**: 
- يجب التأكد من أن ملف القالب المحدد يحتوي على النص المناسب لوصف الفيديوهات.
- يمكن استخدام التعبيرات النمطية (regex) في أنماط البحث والاستبدال لإجراء عمليات بحث واستبدال متقدمة.
- يتم تحديث الصف (`frame.row`) تلقائيًا بعد إضافة كل مجموعة من العناصر لضمان ترتيبها بشكل صحيح في الواجهة.
***
### FunctionDef add_thumbnail_options_widgets(self)
**add_thumbnail_options_widgets**: وظيفة `add_thumbnail_options_widgets` هي إضافة واجهة مستخدم لإدارة خيارات الصور المصغرة (thumbnails) في واجهة YouTube Bulk Uploader GUI.

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters).

**Code Description**: تقوم هذه الدالة بإنشاء واجهة مستخدم تحتوي على عدة عناصر لإدارة خيارات الصور المصغرة (thumbnails) في واجهة YouTube Bulk Uploader GUI. يتم تنفيذ الخطوات التالية:

1. يتم إنشاء تسمية (label) لعرض نص "Filename Prefix:"، ويتم وضعها في الصف الحالي (`frame.row`) والعمود الأول. يتم إرفاق نافذة تلميحية (tooltip) لتوضيح أن هذا الحقل يستخدم لإضافة بادئة (prefix) لاسم ملف الفيديو لمطابقة نمط اسم ملف الصورة المصغرة.

2. يتم إنشاء حقل إدخال (Entry) لإدخال البادئة (prefix) المطلوبة، ويتم ربطه بالمتغير `self.thumb_file_prefix_var`. يتم وضع هذا الحقل في نفس الصف والعمود الثاني، مع إرفاق نافذة تلميحية لتوضيح كيفية استخدام هذا الحقل.

3. يتم زيادة عدد الصفوف (`frame.new_row()`) لإضافة عنصر جديد في الصف التالي.

4. يتم إنشاء تسمية (label) لعرض نص "Filename Suffix:"، ويتم وضعها في الصف الجديد والعمود الأول. يتم إرفاق نافذة تلميحية لتوضيح أن هذا الحقل يستخدم لإضافة لاحقة (suffix) لاسم ملف الفيديو لمطابقة نمط اسم ملف الصورة المصغرة.

5. يتم إنشاء حقل إدخال (Entry) لإدخال اللاحقة (suffix) المطلوبة، ويتم ربطه بالمتغير `self.thumb_file_suffix_var`. يتم وضع هذا الحقل في نفس الصف والعمود الثاني، مع إرفاق نافذة تلميحية لتوضيح كيفية استخدام هذا الحقل.

6. يتم زيادة عدد الصفوف (`frame.new_row()`) لإضافة عنصر جديد في الصف التالي.

7. يتم إنشاء تسمية (label) لعرض نص "File Extensions:"، ويتم وضعها في الصف الجديد والعمود الأول. يتم إرفاق نافذة تلميحية لتوضيح أن هذا الحقل يستخدم لإدخال الامتدادات المسموح بها لملفات الصور المصغرة.

8. يتم إنشاء حقل إدخال (Entry) لإدخال الامتدادات المسموح بها، ويتم ربطه بالمتغير `self.thumb_file_extensions_var`. يتم وضع هذا الحقل في نفس الصف والعمود الثاني، مع إرفاق نافذة تلميحية لتوضيح كيفية استخدام هذا الحقل.

9. يتم زيادة عدد الصفوف (`frame.new_row()`) لإضافة عنصر جديد في الصف التالي.

10. يتم استدعاء الدالة `add_find_replace_widgets` من الإطار `self.thumbnail_frame` لإضافة واجهة مستخدم تحتوي على عناصر لإدارة عمليات البحث والاستبدال للنصوص في أسماء ملفات الصور المصغرة.

يتم استدعاء هذه الدالة في الدالة `create_gui_frames_widgets` عند إنشاء واجهة المستخدم الرئيسية لتطبيق YouTube Bulk Uploader GUI. يتم استخدامها لإضافة إطار خيارات الصور المصغرة (thumbnails) إلى الواجهة، مما يسمح للمستخدم بتحديد البادئة، اللاحقة، الامتدادات المسموح بها، وأنماط البحث والاستبدال لأسماء ملفات الصور المصغرة.

**Note**: 
- يجب التأكد من أن البادئة واللاحقة المدخلة تتوافق مع نمط أسماء ملفات الصور المصغرة لضمان عمل التطبيق بشكل صحيح.
- يمكن استخدام التعبيرات النمطية (regex) في أنماط البحث والاستبدال لإجراء عمليات متقدمة على أسماء الملفات.
- يتم تحديث الصف (`frame.row`) تلقائيًا بعد كل إضافة لعنصر جديد في الواجهة.
***
### FunctionDef set_window_icon(self)
**set_window_icon**: وظيفة set_window_icon هي تعيين أيقونة النافذة لتكون شعار التطبيق.

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters) حيث يتم تنفيذها باستخدام المتغيرات المحددة مسبقًا داخل الكائن (self).

**Code Description**: 
تقوم هذه الدالة بتعيين أيقونة النافذة الرئيسية للتطبيق باستخدام صورة الشعار المحددة. يتم ذلك من خلال البحث عن ملفات الصور (PNG أو ICO) في مسارات محددة مسبقًا داخل مجلد التطبيق (bundle_dir). يتم البحث عن الملفات بالترتيب التالي:
1. logo.png في المجلد الرئيسي للتطبيق.
2. logo.png في مجلد youtube_bulk_upload داخل المجلد الرئيسي.
3. logo.ico في المجلد الرئيسي للتطبيق.
4. logo.ico في مجلد youtube_bulk_upload داخل المجلد الرئيسي.

إذا تم العثور على أحد هذه الملفات، يتم تعيينه كأيقونة للنافذة باستخدام الدالة `iconbitmap` للملفات من نوع ICO أو `wm_iconphoto` للملفات من نوع PNG. إذا لم يتم العثور على أي من الملفات، يتم إطلاق استثناء (FileNotFoundError) للإشارة إلى أن صورة الشعار غير موجودة في المسارات المحددة.

في حالة حدوث أي خطأ أثناء محاولة تعيين الأيقونة، يتم تسجيل الخطأ باستخدام الـ logger الموجود في الكائن.

**العلاقة مع الكائنات الأخرى**:
يتم استدعاء هذه الدالة داخل دالة `__init__` للكائن `YouTubeBulkUploaderGUI`، حيث يتم تعيين أيقونة النافذة مباشرة بعد تهيئة المتغيرات الأساسية وقبل إنشاء واجهة المستخدم الرسومية (GUI). هذا يضمن أن الأيقونة تكون جاهزة بمجرد ظهور النافذة للمستخدم.

**Note**:
- يجب التأكد من وجود ملفات الشعار (PNG أو ICO) في المسارات المحددة لتجنب حدوث أخطاء.
- يتم تسجيل جميع الأحداث (نجاح أو فشل) باستخدام الـ logger، مما يسهل عملية تتبع الأخطاء في حالة حدوثها.
***
### FunctionDef add_textbox_log_handler(self)
**add_textbox_log_handler**: وظيفة `add_textbox_log_handler` هي إضافة معالج (handler) لتسجيل الرسائل (logging) في واجهة المستخدم الرسومية (GUI) باستخدام عنصر نصي (text widget).

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters) حيث تعتمد على السمات (attributes) الموجودة داخل الكلاس `YouTubeBulkUploaderGUI`.

**Code Description**: تقوم هذه الدالة بإضافة معالج لتسجيل الرسائل (log handler) إلى الـ logger الموجود في الكلاس `YouTubeBulkUploaderGUI`. يتم استخدام هذا المعالج لتوجيه الرسائل المسجلة (log messages) إلى عنصر نصي (text widget) في واجهة المستخدم الرسومية (GUI) بحيث يمكن للمستخدم رؤية الرسائل مباشرةً في الواجهة.

تفاصيل الكود:
1. تقوم الدالة بتسجيل رسالة تفيد ببدء إضافة معالج النص (textbox log handler) باستخدام الـ logger الموجود في الكلاس.
2. يتم إنشاء كائن من الكلاس `TextHandler`، حيث يتم تمرير الـ logger وعنصر النص (`self.log_output`) كمعاملات. هذا الكائن مسؤول عن توجيه الرسائل المسجلة إلى عنصر النص في الواجهة الرسومية.
3. يتم إنشاء تنسيق (Formatter) للرسائل المسجلة باستخدام `logging.Formatter`. التنسيق المحدد هنا هو `"%(asctime)s - %(levelname)s - %(module)s - %(message)s"`، مما يعني أن كل رسالة مسجلة ستظهر مع الوقت، مستوى السجل (log level)، اسم الوحدة (module)، والرسالة نفسها.
4. يتم تعيين هذا التنسيق للمعالج (`self.log_handler_textbox`) باستخدام الدالة `setFormatter`.
5. أخيرًا، يتم إضافة المعالج (`self.log_handler_textbox`) إلى الـ logger باستخدام الدالة `addHandler`. هذا يسمح بعرض جميع الرسائل المسجلة في عنصر النص المحدد في الواجهة الرسومية.

العلاقة مع الكائنات الأخرى في المشروع:
- يتم استدعاء هذه الدالة من داخل دالة `__init__` في الكلاس `YouTubeBulkUploaderGUI`. هذا يعني أنه بمجرد إنشاء كائن من هذا الكلاس، يتم إعداد معالج النص تلقائيًا لعرض الرسائل المسجلة في الواجهة الرسومية.
- تعتمد هذه الدالة على الكلاس `TextHandler`، الذي يقوم بتوجيه الرسائل المسجلة إلى عنصر النص في الواجهة الرسومية. يتم استخدام هذا الكلاس لضمان أن الرسائل المسجلة تظهر بشكل صحيح في الواجهة.

**Note**: ملاحظات حول استخدام الكود:
- يجب التأكد من أن عنصر النص (`self.log_output`) قد تم تهيئته بشكل صحيح قبل استدعاء هذه الدالة.
- يتم استخدام تنسيق محدد للرسائل المسجلة، ويمكن تعديل هذا التنسيق حسب الحاجة لتلبية متطلبات المشروع.
- يتم إضافة المعالج إلى الـ logger بشكل دائم، مما يعني أن جميع الرسائل المسجلة بعد ذلك ستظهر في عنصر النص المحدد.
***
### FunctionDef prompt_user_bool(self, prompt_message, allow_empty)
**prompt_user_bool**: وظيفة `prompt_user_bool` هي عرض رسالة للمستخدم عبر واجهة المستخدم الرسومية (GUI) لطلب إدخال قيمة منطقية (boolean) بطريقة آمنة للخيوط (thread-safe).

**parameters**: معاملات هذه الوظيفة.
· `prompt_message`: الرسالة التي سيتم عرضها للمستخدم في مربع الحوار.
· `allow_empty`: معامل غير مستخدم في هذا السياق، ولكنه محفوظ لأغراض التوافقية.

**Code Description**: 
تقوم هذه الوظيفة بعرض مربع حوار للمستخدم يطلب منه إدخال قيمة منطقية (نعم/لا) عبر واجهة المستخدم الرسومية. يتم تنفيذ هذه العملية بطريقة آمنة للخيوط (thread-safe) لضمان عدم حدوث تعارضات عند استخدام الوظيفة في بيئات متعددة الخيوط.

1. يتم تسجيل رسالة تتبع (debug) في السجل (logger) للإشارة إلى بدء عملية طلب الإدخال من المستخدم.
2. يتم تعريف وظيفة داخلية تسمى `prompt` تقوم بعرض مربع حوار باستخدام `messagebox.askyesno`، حيث يتم عرض الرسالة المحددة (`prompt_message`) للمستخدم. يتم تخزين نتيجة الإدخال في المتغير `self.user_input_result`، ثم يتم تشغيل حدث (`self.user_input_event.set()`) للإشارة إلى أن المستخدم قد أدخل قيمة.
3. يتم مسح الحدث (`self.user_input_event.clear()`) قبل بدء عملية الطلب.
4. يتم جدولة تنفيذ الوظيفة `prompt` عبر `self.gui_root.after(0, prompt)`، مما يضمن تنفيذها في سياق واجهة المستخدم الرئيسية.
5. تقوم الوظيفة بإرجاع `None` فورًا، حيث سيتم انتظار إدخال المستخدم لاحقًا.

**Note**: 
- هذه الوظيفة تعتمد على واجهة المستخدم الرسومية (GUI)، لذا يجب أن يتم استدعاؤها في بيئة تدعم واجهة المستخدم.
- المعامل `allow_empty` غير مستخدم حاليًا، ولكن تم تضمينه لأغراض التوافقية مع واجهات أخرى.

**Output Example**: 
في حالة اختيار المستخدم "نعم"، سيكون الإرجاع `True`. في حالة اختيار "لا"، سيكون الإرجاع `False`. إذا تم إلغاء مربع الحوار، سيكون الإرجاع `None`.
#### FunctionDef prompt
**prompt**: وظيفة `prompt` هي عرض نافذة تأكيد للمستخدم وانتظار إدخاله.  
**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters) محددة.  
**Code Description**: تقوم هذه الدالة بعرض نافذة تأكيد (confirmation dialog) للمستخدم باستخدام `messagebox.askyesno`، حيث يتم عرض رسالة التأكيد المحددة في المتغير `prompt_message`. بعد ذلك، يتم تخزين نتيجة إدخال المستخدم (نعم/لا) في المتغير `self.user_input_result`. أخيرًا، يتم تشغيل الحدث `self.user_input_event` باستخدام `set()` للإشارة إلى أن المستخدم قد أدخل إجابة.  
**Note**:  
- يجب أن يكون المتغير `prompt_message` محددًا مسبقًا قبل استدعاء هذه الدالة.  
- يتم استخدام `self.user_input_event` للتحكم في تدفق البرنامج، حيث يمكن للبرنامج الانتظار حتى يتم تلقي إدخال المستخدم.  
- هذه الدالة تعتمد على مكتبة `tkinter.messagebox` لعرض نافذة التأكيد.
***
***
### FunctionDef prompt_user_text(self, prompt_message, default_response)
**prompt_user_text**: وظيفة `prompt_user_text` هي عرض مربع حوار للمستخدم لطلب إدخال نصي عبر واجهة المستخدم الرسومية (GUI).

**parameters**: معاملات هذه الوظيفة.
· `prompt_message`: الرسالة التي سيتم عرضها في مربع الحوار لطلب الإدخال من المستخدم.
· `default_response`: النص الافتراضي الذي سيظهر في مربع الإدخال. هذا المعامل اختياري، وإذا لم يتم تحديده، فسيتم ترك مربع الإدخال فارغًا.

**Code Description**: تقوم هذه الوظيفة بإنشاء مربع حوار باستخدام `simpledialog.askstring` لعرض رسالة للمستخدم وطلب إدخال نصي. يتم تنفيذ مربع الحوار بشكل غير متزامن (asynchronous) باستخدام `self.gui_root.after(0, prompt)`، مما يسمح للواجهة الرسومية بالاستمرار في العمل دون انقطاع. 

عندما يقوم المستخدم بإدخال النص وإغلاق مربع الحوار، يتم تخزين النتيجة في `self.user_input_result`، ويتم تشغيل حدث `self.user_input_event` للإشارة إلى أن الإدخال قد تم استلامه. 

الوظيفة ترجع `None` على الفور، حيث يتم انتظار إدخال المستخدم بشكل غير متزامن. يتم استخدام `self.user_input_event` للتحقق من اكتمال الإدخال في مكان آخر في الكود.

**Note**: 
- يجب أن تكون الواجهة الرسومية (`self.gui_root`) نشطة ومهيأة بشكل صحيح قبل استدعاء هذه الوظيفة.
- يتم استخدام `self.user_input_event` للتحقق من اكتمال الإدخال، لذا يجب التأكد من أن هذا الحدث يتم التحقق منه في الكود الذي يستدعي هذه الوظيفة.

**Output Example**: 
```python
# عند استدعاء الوظيفة
result = prompt_user_text("الرجاء إدخال اسمك:", "مستخدم")
# إذا أدخل المستخدم "أحمد" في مربع الحوار
print(result)  # سيكون الناتج: "أحمد"
# إذا ألغى المستخدم مربع الحوار
print(result)  # سيكون الناتج: None
```
#### FunctionDef prompt
Doc is waiting to be generated...
***
***
### FunctionDef stop_operation(self)
**stop_operation**: وظيفة `stop_operation` هي إيقاف العملية الحالية التي يتم تنفيذها في واجهة المستخدم الرسومية (GUI) الخاصة بأداة تحميل الفيديوهات على YouTube بشكل جماعي.

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters).

**Code Description**: تقوم وظيفة `stop_operation` بإيقاف العملية الجارية في واجهة المستخدم الرسومية. يتم ذلك عن طريق تسجيل رسالة في السجل (log) تفيد بأن العملية الحالية يتم إيقافها، ثم يتم تفعيل حدث الإيقاف (`stop_event.set()`). هذا الحدث (`stop_event`) هو جزء من آلية التحكم في العمليات التي يتم تنفيذها في الخلفية، حيث يتم استخدامه لإعلام العمليات الأخرى بضرورة التوقف عن التنفيذ.

في سياق المشروع، يتم استدعاء هذه الوظيفة من خلال زر "Stop" في واجهة المستخدم الرسومية. يتم إنشاء هذا الزر في وظيفة `create_gui_frames_widgets`، حيث يتم تعيين الأمر (`command`) الخاص بالزر لاستدعاء `stop_operation` عند النقر عليه. هذا يعني أن المستخدم يمكنه النقر على زر "Stop" لإيقاف أي عملية جارية، مثل تحميل الفيديوهات أو أي عملية أخرى يتم تنفيذها في الخلفية.

**Note**: يجب التأكد من أن الحدث `stop_event` يتم إدارته بشكل صحيح في الأجزاء الأخرى من الكود التي تعتمد عليه لإيقاف العمليات الجارية. إذا لم يتم التعامل مع هذا الحدث بشكل صحيح، فقد لا يتم إيقاف العمليات بشكل فعال.
***
### FunctionDef update_progress(self, progress)
**update_progress**: وظيفة `update_progress` هي تحديث شريط التقدم (progress bar) في واجهة المستخدم الرسومية (GUI) بناءً على قيمة التقدم المقدمة.

**parameters**: معاملات هذه الوظيفة.
· `progress`: قيمة التقدم التي يتم تمريرها لتحديث شريط التقدم. يجب أن تكون قيمة بين 0 و1، حيث تمثل 0 عدم التقدم وتمثل 1 اكتمال المهمة.

**Code Description**: 
تقوم هذه الوظيفة بتحديث شريط التقدم في واجهة المستخدم الرسومية (GUI) بناءً على قيمة التقدم المقدمة. يتم ذلك عبر الخطوات التالية:
1. تسجيل قيمة التقدم في السجل (logger) باستخدام `self.logger.info` لعرض رسالة تحتوي على قيمة التقدم الحالية.
2. تحديث قيمة شريط التقدم (`self.progress_bar["value"]`) بضرب قيمة التقدم في 100 لتحويلها إلى نسبة مئوية، حيث يتوقع شريط التقدم قيمًا بين 0 و100.

يتم استدعاء هذه الوظيفة من خلال الكائن `YouTubeBulkUploaderGUI` في وظيفة `run_upload`. يتم تمرير `update_progress` كدالة رد اتصال (`progress_callback_func`) إلى كائن `YouTubeBulkUpload`، مما يسمح لعملية التحميل بتحديث شريط التقدم في الواجهة الرسومية أثناء تنفيذها. هذا يضمن أن المستخدم يمكنه رؤية التقدم الحالي لعملية التحميل بشكل مباشر.

**Note**: 
- يجب أن تكون قيمة `progress` بين 0 و1، حيث تمثل 0 بداية المهمة و1 اكتمالها.
- يتم تحويل قيمة التقدم إلى نسبة مئوية (0-100) لتتناسب مع توقعات شريط التقدم في الواجهة الرسومية.
- هذه الوظيفة تعتمد على وجود `self.progress_bar` و`self.logger` في الكائن الذي يستدعيها، لذا يجب التأكد من تهيئتهما بشكل صحيح قبل الاستخدام.
***
### FunctionDef run_upload(self)
**run_upload**: وظيفة `run_upload` هي بدء عملية تحميل الفيديوهات إلى YouTube باستخدام الإعدادات المحددة من واجهة المستخدم الرسومية (GUI).

**parameters**: لا تحتوي هذه الوظيفة على معاملات (parameters) حيث تعتمد على القيم المخزنة في متغيرات الكائن (`self`) التي تم تعيينها من خلال واجهة المستخدم الرسومية.

**Code Description**: 
تقوم وظيفة `run_upload` بجمع جميع الإعدادات المحددة من واجهة المستخدم الرسومية (GUI) وتهيئة كائن من فئة `YouTubeBulkUpload` لبدء عملية تحميل الفيديوهات إلى YouTube. يتم ذلك عبر الخطوات التالية:

1. **تسجيل بدء العملية**: يتم تسجيل رسالة في السجل (log) تشير إلى بدء تهيئة عملية التحميل.
2. **جمع الإعدادات**: يتم جمع جميع الإعدادات من واجهة المستخدم الرسومية، مثل:
   - `dry_run`: تحديد ما إذا كانت العملية تجريبية (بدون تحميل فعلي).
   - `noninteractive`: تحديد ما إذا كانت العملية تفاعلية مع المستخدم أم لا.
   - `source_directory`: المجلد الذي يحتوي على ملفات الفيديو المراد تحميلها.
   - `yt_client_secrets_file`: ملف اعتماد العميل للوصول إلى YouTube API.
   - `yt_category_id`: فئة الفيديو على YouTube.
   - `yt_keywords`: الكلمات المفتاحية المرتبطة بالفيديو.
   - `yt_desc_template_file`: ملف قالب لوصف الفيديو.
   - `yt_title_prefix` و `yt_title_suffix`: البادئة واللاحقة لعنوان الفيديو.
   - `thumb_file_prefix` و `thumb_file_suffix`: البادئة واللاحقة لاسم ملف الصورة المصغرة.
   - `thumb_file_extensions`: امتدادات ملفات الصور المصغرة المقبولة.
   - `privacy_status`: حالة الخصوصية للفيديو (خاص، عام، غير مدرج).

3. **استخراج أنماط الاستبدال**: يتم استخراج أنماط الاستبدال (replacements) من واجهة المستخدم الرسومية باستخدام وظيفة `get_replacements` من الأطر (frames) المختلفة مثل `youtube_desc_frame`، `youtube_title_frame`، و `thumbnail_frame`. هذه الأنماط تستخدم لتعديل العناوين، الأوصاف، وأسماء ملفات الصور المصغرة.

4. **تهيئة كائن YouTubeBulkUpload**: يتم إنشاء كائن من فئة `YouTubeBulkUpload` باستخدام الإعدادات المجمعة وأنماط الاستبدال. يتم تمرير دالة `update_progress` كدالة رد اتصال (callback) لتحديث شريط التقدم في واجهة المستخدم الرسومية أثناء عملية التحميل.

5. **بدء عملية التحميل في خيط منفصل**: يتم بدء عملية التحميل في خيط منفصل (thread) باستخدام وظيفة `threaded_upload` لمنع تجميد واجهة المستخدم الرسومية أثناء العملية. يتم تمرير كائن `YouTubeBulkUpload` إلى هذه الوظيفة لتنفيذ عملية التحميل الفعلية.

**Note**: 
- يجب التأكد من تعيين جميع الإعدادات بشكل صحيح في واجهة المستخدم الرسومية قبل استدعاء هذه الوظيفة.
- يتم استخدام الخيوط (threads) لضمان استمرارية تحديث واجهة المستخدم الرسومية أثناء عملية التحميل.
- في حالة تفعيل `dry_run`، لن يتم تحميل أي فيديو إلى YouTube، وسيتم فقط تسجيل الإجراءات التي كان سيتم تنفيذها.
***
### FunctionDef on_closing(self)
Doc is waiting to be generated...
***
### FunctionDef threaded_upload(self, youtube_bulk_upload)
**threaded_upload**: وظيفة `threaded_upload` هي تنفيذ عملية تحميل الفيديوهات إلى YouTube في خيط منفصل (thread) لمنع تجميد واجهة المستخدم الرسومية (GUI) أثناء العملية.

**parameters**: معاملات هذه الوظيفة.
· `youtube_bulk_upload`: كائن من فئة `YouTubeBulkUpload` الذي يحتوي على الإعدادات والبيانات اللازمة لتنفيذ عملية التحميل.

**Code Description**: 
تقوم هذه الوظيفة بتنفيذ عملية تحميل الفيديوهات إلى YouTube باستخدام الكائن `youtube_bulk_upload` الذي يتم تمريره كمعامل. يتم بدء العملية بتسجيل رسالة في السجل (log) تشير إلى بدء التحميل. بعد ذلك، يتم استدعاء دالة `process()` من الكائن `youtube_bulk_upload` لتنفيذ عملية التحميل الفعلية. 

في حالة نجاح التحميل، يتم عرض رسالة نجاح في واجهة المستخدم الرسومية (GUI) باستخدام `messagebox.showinfo`، حيث يتم عرض عدد الفيديوهات التي تم تحميلها بنجاح. يتم استخدام `self.gui_root.after(0, ...)` لضمان تحديث واجهة المستخدم الرسومية بشكل صحيح من خلال الخيط الرئيسي.

في حالة حدوث خطأ أثناء التحميل، يتم تسجيل رسالة الخطأ في السجل (log) باستخدام `self.logger.error`، ويتم أيضًا عرض رسالة الخطأ في واجهة المستخدم الرسومية باستخدام `messagebox.showerror`. يتم استخدام نفس الأسلوب (`self.gui_root.after(0, ...)`) لضمان تحديث واجهة المستخدم الرسومية بشكل صحيح.

**Note**: 
- يتم تنفيذ هذه الوظيفة في خيط منفصل (thread) لمنع تجميد واجهة المستخدم الرسومية أثناء عملية التحميل.
- يتم استخدام `self.gui_root.after(0, ...)` لضمان تحديث واجهة المستخدم الرسومية من الخيط الرئيسي، مما يمنع حدوث مشاكل في تحديث الواجهة.
- يجب التأكد من أن الكائن `youtube_bulk_upload` يحتوي على جميع الإعدادات والبيانات اللازمة قبل استدعاء هذه الوظيفة.
***
### FunctionDef select_client_secrets_file(self)
**select_client_secrets_file**: وظيفة `select_client_secrets_file` هي فتح نافذة حوار لتحديد ملف أسرار العميل (client secrets file) الخاص بـ YouTube API.

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters) حيث يتم تنفيذها مباشرةً من خلال الكائن الحالي (`self`).

**Code Description**: 
تقوم هذه الوظيفة بتنفيذ الخطوات التالية:
1. تسجيل رسالة تفيد ببدء عملية تحديد ملف أسرار العميل في سجل الأحداث (logger) باستخدام مستوى `debug`.
2. فتح نافذة حوار تسمح للمستخدم بتحديد ملف من نوع JSON باستخدام `filedialog.askopenfilename`. يتم عرض النافذة بعنوان "Select Client Secrets File" وتسمح فقط باختيار ملفات ذات امتداد `.json`.
3. إذا قام المستخدم بتحديد ملف بنجاح، يتم تعيين مسار هذا الملف إلى المتغير `yt_client_secrets_file_var` باستخدام الدالة `set`.

ترتبط هذه الوظيفة بواجهة المستخدم الرسومية (GUI) حيث يتم استدعاؤها عند النقر على زر "Browse..." بجوار حقل إدخال ملف أسرار العميل. يتم ذلك في الوظيفة `add_general_options_widgets`، حيث يتم إنشاء زر "Browse..." وربطه بهذه الوظيفة. هذا يعني أن الوظيفة تعمل كجزء من عملية إعداد الإعدادات العامة لتطبيق تحميل الفيديوهات على YouTube بشكل مجمّع.

**Note**: 
- يجب أن يكون الملف المحدد بتنسيق JSON وصالحًا للاستخدام مع YouTube Data API.
- إذا لم يتم تحديد ملف، لن يتم تغيير قيمة المتغير `yt_client_secrets_file_var`.
***
### FunctionDef select_source_directory(self)
Doc is waiting to be generated...
***
### FunctionDef select_yt_desc_template_file(self)
Doc is waiting to be generated...
***
### FunctionDef clear_log(self)
**clear_log**: وظيفة clear_log هي مسح محتويات نافذة السجل (log output) في واجهة المستخدم الرسومية (GUI).

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters).

**Code Description**: تقوم وظيفة clear_log بتنفيذ الخطوات التالية:
1. تسجيل رسالة تفيد بأنه يتم مسح محتويات نافذة السجل باستخدام `self.logger.debug("Clearing log output")`.
2. تفعيل نافذة السجل (`self.log_output`) للتحرير عن طريق تغيير حالة النافذة إلى `tk.NORMAL` باستخدام `self.log_output.config(state=tk.NORMAL)`.
3. مسح جميع المحتويات الحالية في نافذة السجل باستخدام `self.log_output.delete("1.0", tk.END)`، حيث يتم حذف النص من البداية (`1.0`) إلى النهاية (`tk.END`).
4. تعطيل نافذة السجل مرة أخرى بعد الانتهاء من المسح باستخدام `self.log_output.config(state=tk.DISABLED)`، مما يمنع المستخدم من التعديل المباشر على النافذة.

يتم استدعاء هذه الوظيفة من خلال زر "Clear Log" في واجهة المستخدم الرسومية، والذي تم إنشاؤه في وظيفة `create_gui_frames_widgets`. يتم تعيين الأمر `command=self.clear_log` للزر، مما يعني أنه عند النقر على الزر، سيتم تنفيذ وظيفة `clear_log` لمسح محتويات نافذة السجل.

**Note**: 
- تأكد من أن نافذة السجل (`self.log_output`) تم تهيئتها بشكل صحيح قبل استدعاء هذه الوظيفة.
- يتم تعطيل نافذة السجل بعد المسح لمنع المستخدمين من التعديل المباشر على النص المعروض.
***
### FunctionDef reset_youtube_auth(self)
**reset_youtube_auth**: وظيفة `reset_youtube_auth` هي حذف ملف رمز مصادقة YouTube المحفوظ مؤقتًا.

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters).

**Code Description**: 
تقوم هذه الوظيفة بحذف ملف رمز مصادقة YouTube الذي يتم تخزينه مؤقتًا في مجلد الملفات المؤقتة (temp directory) على النظام. يتم تنفيذ هذه العملية بالخطوات التالية:

1. يتم تسجيل رسالة في السجل (log) تفيد ببدء عملية إعادة تعيين مصادقة YouTube.
2. يتم استيراد مكتبتي `tempfile` و`os` للوصول إلى الملفات والمجلدات المؤقتة.
3. يتم تحديد مسار ملف الرمز المحفوظ باستخدام `tempfile.gettempdir()`، حيث يتم تخزين الملف باسم `youtube-bulk-upload-token.pickle`.
4. يتم التحقق من وجود الملف باستخدام `os.path.exists()`. إذا كان الملف موجودًا، يتم حذفه باستخدام `os.remove()`، ويتم تسجيل رسالة تفيد بنجاح عملية الحذف.
5. إذا تم حذف الملف بنجاح، يتم عرض رسالة للمستخدم تفيد بأن مصادقة YouTube تم إعادة تعيينها بنجاح، وسيحتاج إلى إعادة المصادقة في المرة القادمة التي يحاول فيها التحميل.
6. إذا لم يتم العثور على الملف، يتم تسجيل رسالة تفيد بعدم وجود رمز مصادقة، ويتم عرض رسالة للمستخدم تفيد بعدم وجود رمز مصادقة.
7. في حالة حدوث أي خطأ أثناء العملية، يتم تسجيل رسالة خطأ في السجل وعرض رسالة خطأ للمستخدم.

يتم استدعاء هذه الوظيفة من خلال زر "Reset YouTube Auth" في واجهة المستخدم الرسومية (GUI) للبرنامج، والذي يتم إنشاؤه في وظيفة `create_gui_frames_widgets`. يتم تعيين الأمر `command=self.reset_youtube_auth` للزر، مما يعني أنه عند النقر على الزر، سيتم تنفيذ هذه الوظيفة.

**Note**: 
- يجب استخدام هذه الوظيفة إذا أراد المستخدم تبديل حسابات YouTube أو إذا واجه مشاكل في المصادقة الحالية.
- بعد تنفيذ هذه الوظيفة، سيحتاج المستخدم إلى إعادة المصادقة في المرة القادمة التي يحاول فيها تحميل مقاطع الفيديو.
- يتم تخزين رمز المصادقة في ملف مؤقت، لذا فإن حذفه لن يؤثر على أي بيانات أخرى في النظام.
***
## ClassDef ReusableWidgetFrame
**ReusableWidgetFrame**: وظيفة ReusableWidgetFrame هي توفير إطار قابل لإعادة الاستخدام لإضافة عناصر واجهة المستخدم (widgets) في تطبيقات واجهة المستخدم الرسومية (GUI) باستخدام مكتبة tkinter.

**attributes**: السمات الخاصة بهذا الكلاس.
· `parent`: الإطار الرئيسي الذي سيتم إضافة ReusableWidgetFrame إليه.
· `logger`: كائن لتسجيل الأحداث والعمليات (logging) لمراقبة وتصحيح الأخطاء.
· `title`: النص الذي سيظهر كعنوان للإطار.
· `find_var`: متغير نصي (StringVar) لتخزين النص المطلوب البحث عنه.
· `replace_var`: متغير نصي (StringVar) لتخزين النص البديل.
· `row`: متغير لتتبع الصف التالي الذي سيتم إضافة العناصر إليه.

**Code Description**: وصف تفصيلي لهذا الكلاس.
تم تصميم ReusableWidgetFrame ليكون إطارًا مرنًا يمكن استخدامه في تطبيقات واجهة المستخدم الرسومية (GUI) باستخدام مكتبة tkinter. هذا الإطار يوفر طريقة سهلة لإضافة عناصر واجهة المستخدم (widgets) مثل النصوص، حقول الإدخال، الأزرار، والقوائم مع إمكانية إضافة نصائح (tooltips) لتوضيح وظيفة كل عنصر.

يبدأ الكلاس بتهيئة الإطار باستخدام `tk.LabelFrame` مع إضافة بعض الإعدادات الافتراضية مثل الحشو (padding) على المحورين x و y. يتم أيضًا تهيئة متغيرين نصيين (`find_var` و `replace_var`) لتخزين النصوص التي سيتم البحث عنها واستبدالها.

يحتوي الكلاس على عدة وظائف:
1. `new_row`: تزيد من قيمة `row` لإضافة صف جديد للإطار.
2. `add_widgets`: تضيف عناصر واجهة المستخدم (widgets) إلى الإطار وتضعها في الصف التالي.
3. `add_find_replace_widgets`: تضيف مجموعة من العناصر الخاصة بالبحث والاستبدال، بما في ذلك قائمة لعرض أزواج البحث والاستبدال، وحقلي إدخال لإضافة أزواج جديدة، وأزرار لإضافة أو إزالة الأزواج.
4. `add_replacement`: تضيف زوج بحث واستبدال جديد إلى القائمة.
5. `remove_replacement`: تزيل الأزواج المحددة من القائمة.
6. `get_replacements`: تعيد قائمة بأزواج البحث والاستبدال المخزنة في القائمة.

في المشروع، يتم استخدام ReusableWidgetFrame في `YouTubeBulkUploaderGUI` لإنشاء إطارات مختلفة مثل "General Options"، "YouTube Title Options"، "YouTube Thumbnail Options"، و "YouTube Description Options". كل إطار يستخدم ReusableWidgetFrame لإضافة عناصر واجهة المستخدم الخاصة به، مما يجعل الكود أكثر تنظيماً وقابلية لإعادة الاستخدام.

**Note**: ملاحظات حول استخدام الكود.
- يجب التأكد من تهيئة `logger` بشكل صحيح قبل استخدام هذا الكلاس لتسجيل الأحداث.
- يمكن تعديل الحشو (padding) والإعدادات الأخرى حسب الحاجة عن طريق تمريرها كمعلمات إضافية (`**kwargs`).
- يجب التأكد من أن العناصر المضافة إلى الإطار متوافقة مع تخطيط الشبكة (grid layout) المستخدم في tkinter.

**Output Example**: مثال على القيمة التي يمكن أن يعيدها الكود.
عند استدعاء `get_replacements`، يمكن أن تعيد الدالة قائمة بأزواج البحث والاستبدال مثل:
```python
[("بحث1", "استبدال1"), ("بحث2", "استبدال2")]
```
### FunctionDef __init__(self, parent, logger, title)
Doc is waiting to be generated...
***
### FunctionDef new_row(self)
**new_row**: وظيفة `new_row` هي زيادة عدد الصفوف في إطار الواجهة الرسومية (GUI) بمقدار واحد.

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters).

**Code Description**: تقوم الدالة `new_row` بزيادة قيمة العداد `self.row` بمقدار واحد في كل مرة يتم استدعاؤها. يتم استخدام هذه الدالة في إطار الواجهة الرسومية (GUI) لإضافة صف جديد عند ترتيب العناصر في الواجهة. يتم تسجيل عملية إضافة الصف الجديد في سجل الأحداث (logger) باستخدام مستوى `debug`، مما يساعد في تتبع العمليات أثناء التطوير أو تصحيح الأخطاء.

في المشروع، يتم استدعاء هذه الدالة بشكل متكرر في عدة أجزاء من الكود، مثل `add_general_options_widgets`، `add_youtube_title_widgets`، `add_youtube_description_widgets`، و`add_thumbnail_options_widgets`. يتم استخدامها لتنظيم العناصر في الواجهة الرسومية بشكل متسلسل، حيث يتم زيادة عدد الصفوف بعد إضافة كل مجموعة من العناصر لضمان عدم تداخل العناصر مع بعضها البعض.

**Note**: يجب التأكد من أن العداد `self.row` يتم تهيئته بشكل صحيح قبل استخدام هذه الدالة، حيث أن أي خطأ في التهيئة قد يؤدي إلى ترتيب غير صحيح للعناصر في الواجهة الرسومية.
***
### FunctionDef add_widgets(self, widgets)
Doc is waiting to be generated...
***
### FunctionDef add_find_replace_widgets(self, label_text, summary_tooltip_text)
**add_find_replace_widgets**: وظيفة `add_find_replace_widgets` هي إضافة واجهة مستخدم تحتوي على عناصر لإدارة عمليات البحث والاستبدال للنصوص.

**parameters**: معاملات هذه الوظيفة.
· `label_text`: النص الذي سيتم عرضه كتسمية (label) للواجهة.
· `summary_tooltip_text`: النص الذي سيتم عرضه كنافذة تلميحية (tooltip) لتوضيح الغرض من الواجهة.

**Code Description**: تقوم هذه الوظيفة بإنشاء واجهة مستخدم تحتوي على عدة عناصر لإدارة عمليات البحث والاستبدال للنصوص. يتم تنفيذ الخطوات التالية:

1. يتم إنشاء تسمية (label) باستخدام `tk.Label` لعرض النص المحدد في `label_text`، ويتم وضعها في الصف الحالي (`self.row`) والعمود الأول. يتم أيضًا إرفاق نافذة تلميحية (tooltip) باستخدام الكلاس `Tooltip` لتوضيح الغرض من الواجهة.

2. يتم إنشاء قائمة (Listbox) مع شريط تمرير (Scrollbar) لعرض أزواج البحث والاستبدال الحالية. يتم وضع القائمة في الصف التالي (`self.row + 1`) وتوسيعها لتمتد عبر عمودين. يتم إرفاق نافذة تلميحية لتوضيح أن القائمة تعرض أزواج البحث والاستبدال الحالية.

3. يتم إنشاء حقلي إدخال (Entry) لإدخال النص المطلوب البحث عنه (`find_entry`) والنص المطلوب استبداله (`replace_entry`). يتم وضع هذين الحقلين في الصف التالي (`self.row + 2`) ويتم إرفاق نوافذ تلميحية لتوضيح كيفية استخدام الحقول، بما في ذلك دعم بناء الجملة الخاص بالتعبيرات النمطية (regex).

4. يتم إنشاء زرين (Button) لإضافة زوج جديد من البحث والاستبدال (`add_button`) وإزالة الزوج المحدد (`remove_button`). يتم وضع هذين الزرين في الصف التالي (`self.row + 3`) ويتم إرفاق نوافذ تلميحية لتوضيح وظيفة كل زر.

ترتبط هذه الوظيفة بوظيفتي `add_replacement` و`remove_replacement`، حيث يتم استدعاء `add_replacement` عند النقر على زر "Add Replacement" لإضافة زوج جديد إلى القائمة، ويتم استدعاء `remove_replacement` عند النقر على زر "Remove Selected" لإزالة الزوج المحدد من القائمة.

يتم استدعاء هذه الوظيفة في عدة أجزاء من واجهة المستخدم في مشروع YouTube Bulk Uploader GUI، مثل `add_youtube_title_widgets`، `add_youtube_description_widgets`، و`add_thumbnail_options_widgets`، حيث يتم استخدامها لإدارة عمليات البحث والاستبدال في عناوين الفيديوهات، أوصاف الفيديوهات، وأسماء ملفات الصور المصغرة (thumbnails).

**Note**: 
- يجب التأكد من إدخال نص صحيح في حقلي البحث والاستبدال قبل الضغط على زر الإضافة.
- يمكن استخدام التعبيرات النمطية (regex) في حقلي البحث والاستبدال لإجراء عمليات بحث واستبدال متقدمة.
- يتم تحديث الصف (`self.row`) تلقائيًا بعد كل إضافة لعنصر جديد في الواجهة.
***
### FunctionDef add_replacement(self)
**add_replacement**: وظيفة `add_replacement` هي إضافة زوج جديد من النصوص للبحث والاستبدال إلى قائمة الاستبدالات.

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters) حيث يتم استدعاؤها مباشرة من خلال زر في الواجهة الرسومية.

**Code Description**: تقوم هذه الوظيفة بإضافة زوج جديد من النصوص للبحث والاستبدال إلى قائمة الاستبدالات (`replacements_listbox`). يتم تنفيذ الخطوات التالية:

1. تسجيل رسالة تفيد بإضافة استبدال جديد باستخدام `self.logger.debug`.
2. استرجاع النص المطلوب البحث عنه (`find_text`) من المتغير `self.find_var` باستخدام `self.find_var.get()`.
3. استرجاع النص المطلوب استبداله (`replace_text`) من المتغير `self.replace_var` باستخدام `self.replace_var.get()`.
4. إذا كان النص المطلوب البحث عنه (`find_text`) غير فارغ، يتم إدراج الزوج الجديد في قائمة الاستبدالات (`replacements_listbox`) باستخدام `self.replacements_listbox.insert`. يتم إدراج النص بالصيغة `"find_text -> replace_text"`.
5. بعد إضافة الزوج الجديد، يتم مسح حقلي النص (`find_var` و `replace_var`) عن طريق تعيينهما إلى قيم فارغة باستخدام `self.find_var.set("")` و `self.replace_var.set("")`.

يتم استدعاء هذه الوظيفة من خلال زر "Add Replacement" في الواجهة الرسومية، والذي يتم إنشاؤه في وظيفة `add_find_replace_widgets`. تعمل هذه الوظيفة بشكل متكامل مع الواجهة الرسومية لتسهيل إدارة قائمة الاستبدالات.

**Note**: 
- يجب التأكد من إدخال نص للبحث عنه (`find_text`) قبل الضغط على زر الإضافة، حيث لن يتم إضافة أي شيء إذا كان الحقل فارغًا.
- يتم مسح حقلي النص تلقائيًا بعد الإضافة لتسهيل إدخال زوج جديد.
***
### FunctionDef remove_replacement(self)
**remove_replacement**: وظيفة `remove_replacement` هي إزالة العناصر المحددة من قائمة الاستبدالات (replacements) في واجهة المستخدم.

**parameters**: لا تحتوي هذه الوظيفة على أي معاملات (parameters) حيث يتم تنفيذها مباشرة على الكائن الحالي (`self`).

**Code Description**: تقوم هذه الوظيفة بإزالة العناصر المحددة من قائمة الاستبدالات (`replacements_listbox`) في واجهة المستخدم. يتم ذلك من خلال الخطوات التالية:
1. تسجيل رسالة تفيد بأنه يتم إزالة الاستبدالات المحددة باستخدام `self.logger.debug`.
2. الحصول على مؤشرات العناصر المحددة في القائمة باستخدام `self.replacements_listbox.curselection()`.
3. يتم تكرار العناصر المحددة بترتيب عكسي (من الأحدث إلى الأقدم) باستخدام `reversed` لتجنب مشاكل في تحديث المؤشرات عند الحذف.
4. يتم حذف كل عنصر محدد من القائمة باستخدام `self.replacements_listbox.delete(i)`.

ترتبط هذه الوظيفة بوظيفة `add_find_replace_widgets` التي تقوم بإنشاء واجهة المستخدم الخاصة بإضافة وإزالة استبدالات النصوص. حيث يتم استدعاء `remove_replacement` عند النقر على زر "Remove Selected" لإزالة العناصر المحددة من القائمة.

**Note**: 
- يجب التأكد من تحديد عنصر واحد على الأقل في القائمة قبل استدعاء هذه الوظيفة، وإلا لن يتم حذف أي عنصر.
- يتم حذف العناصر بترتيب عكسي لتجنب حدوث أخطاء في تحديث المؤشرات أثناء عملية الحذف.
***
### FunctionDef get_replacements(self)
**get_replacements**: وظيفة `get_replacements` هي استخراج قائمة من أنماط الاستبدال المدخلة من خلال واجهة المستخدم الرسومية (GUI) وتنسيقها في قائمة من الأزواج (find, replace).

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters) حيث تعتمد فقط على البيانات المخزنة في `self.replacements_listbox`.

**Code Description**: 
تقوم هذه الدالة بجمع البيانات المدخلة من خلال `self.replacements_listbox`، وهو عنصر واجهة مستخدم من نوع `Listbox` في مكتبة `tkinter`. يتم استرجاع جميع العناصر الموجودة في `Listbox` باستخدام الأمر `self.replacements_listbox.get(0, tk.END)`، والذي يعيد قائمة تحتوي على جميع العناصر من الفهرس 0 إلى الفهرس الأخير. 

بعد ذلك، يتم تقسيم كل عنصر في القائمة إلى جزأين باستخدام الفاصل `" -> "`. الجزء الأول يمثل النص المراد البحث عنه (`find`)، والجزء الثاني يمثل النص الذي سيتم استبداله (`replace`). يتم تخزين هذه الأزواج في قائمة تسمى `replacements`، والتي يتم إرجاعها في النهاية.

تُستخدم هذه الدالة في مشروع YouTube Bulk Uploader لاستخراج أنماط الاستبدال التي يتم إدخالها من قبل المستخدم لتعديل عناوين الفيديوهات، أوصاف الفيديوهات، وأسماء ملفات الصور المصغرة (thumbnails). يتم استدعاء هذه الدالة من قبل وظيفتين رئيسيتين في المشروع:
1. `save_gui_config_options`: حيث يتم استخراج أنماط الاستبدال وحفظها في ملف تكوين (config file) لتخزين إعدادات واجهة المستخدم.
2. `run_upload`: حيث يتم استخراج أنماط الاستبدال واستخدامها أثناء عملية تحميل الفيديوهات إلى YouTube لتطبيق التعديلات المطلوبة على العناوين والأوصاف وأسماء الملفات.

**Note**: 
- يجب أن تكون العناصر في `Listbox` بتنسيق صحيح، أي أن كل عنصر يجب أن يحتوي على الفاصل `" -> "` لفصل النص المراد البحث عنه عن النص الذي سيتم استبداله.
- في حالة وجود تنسيق غير صحيح، قد يؤدي ذلك إلى أخطاء أثناء تقسيم النص.

**Output Example**: 
مثال على القيمة التي يمكن أن تُرجعها الدالة:
```python
[
    ("old_text1", "new_text1"),
    ("old_text2", "new_text2"),
    ("old_text3", "new_text3")
]
```
***
## ClassDef Tooltip
**Tooltip**: وظيفة الـ Tooltip هي إنشاء نافذة تلميحية (tooltip) لعنصر واجهة المستخدم (widget) لعرض نص مساعد عند تحريك المؤشر فوق العنصر.

**attributes**: السمات الخاصة بهذا الكلاس.
· widget: العنصر الذي سيتم إرفاق الـ tooltip به.
· text: النص الذي سيتم عرضه في الـ tooltip.
· tooltip_window: النافذة المؤقتة التي تعرض الـ tooltip.

**Code Description**: 
يتمثل دور هذا الكلاس في إنشاء نافذة تلميحية (tooltip) لعنصر واجهة المستخدم (widget) باستخدام مكتبة tkinter. عند تحريك المؤشر فوق العنصر (event "<Enter>")، يتم إنشاء نافذة صغيرة (Toplevel) تعرض النص المحدد. يتم تحديد موقع النافذة بناءً على موقع العنصر على الشاشة، مع تعديل بسيط في الإحداثيات لتظهر النافذة فوق العنصر أو بجواره. عند إزالة المؤشر من العنصر (event "<Leave>")، يتم تدمير النافذة التلميحية.

يتم استخدام هذا الكلاس في عدة أجزاء من واجهة المستخدم في مشروع YouTube Bulk Uploader GUI، حيث يتم إرفاق الـ tooltips بالعديد من العناصر مثل الأزرار (Buttons)، وخانات الإدخال (Entry)، والقوائم (OptionMenu)، وغيرها. على سبيل المثال، يتم استخدامه لعرض نصائح مساعدة عند تحريك المؤشر فوق زر "Run" لشرح وظيفته، أو فوق خيارات القائمة لتوضيح معنى كل خيار.

**Note**: 
- يمكن تعديل قيمة الإحداثيات (y += 28) لتغيير موقع ظهور الـ tooltip بالنسبة للعنصر.
- يجب التأكد من أن النص المعروض في الـ tooltip واضح وموجز لضمان تجربة مستخدم جيدة.
- يتم تدمير النافذة التلميحية تلقائيًا عند إزالة المؤشر من العنصر، مما يضمن عدم تراكم النوافذ غير الضرورية.
### FunctionDef __init__(self, widget, text)
Doc is waiting to be generated...
***
### FunctionDef enter(self, event)
**enter**: وظيفة `enter` هي عرض نافذة تلميح (tooltip) فوق عنصر واجهة المستخدم (widget) عند مرور المؤشر فوقه.

**parameters**: معاملات هذه الوظيفة.
· `event`: معامل اختياري يمثل الحدث الذي يتم تشغيل الوظيفة بناءً عليه. القيمة الافتراضية هي `None`.

**Code Description**: 
تقوم وظيفة `enter` بإنشاء نافذة تلميح (tooltip) تظهر فوق عنصر واجهة المستخدم (widget) عند مرور المؤشر فوقه. يتم تحديد موقع النافذة بناءً على موقع العنصر على الشاشة. يتم استخدام الدالة `winfo_rootx()` و `winfo_rooty()` للحصول على إحداثيات العنصر على الشاشة، ثم يتم تعديل الإحداثيات لتظهر النافذة فوق العنصر مباشرة.

بعد ذلك، يتم إنشاء نافذة من نوع `Toplevel` باستخدام `tk.Toplevel(self.widget)`، وتتم إزالة الإطار الافتراضي للنافذة باستخدام `wm_overrideredirect(True)` لتظهر كنافذة بسيطة بدون إطارات. يتم تحديد موقع النافذة باستخدام `wm_geometry()` بناءً على الإحداثيات التي تم حسابها مسبقًا.

يتم إنشاء تسمية (Label) داخل النافذة لعرض النص المحدد (`self.text`) كتلميح. يتم تكوين التسمية بحيث يكون النص مبررًا إلى اليسار، مع وجود حواف داخلية (`padx` و `pady`) وإطار مرئي (`borderwidth` و `relief`). كما يتم تحديد لون الحدود (`highlightbackground` و `highlightcolor`) وسمك الحدود (`highlightthickness`) لإضافة مظهر مرئي مميز. يتم أيضًا تحديد طول النص (`wraplength`) لضمان أن النص لا يتجاوز عرض معين.

**Note**: 
- يتم استدعاء هذه الوظيفة تلقائيًا عند مرور المؤشر فوق العنصر (`widget`) المرتبط بها، وذلك بفضل الربط الذي تم إنشاؤه في دالة `__init__` باستخدام `widget.bind("<Enter>", self.enter)`.
- يمكن تعديل قيمة الإزاحة الرأسية (`y += 28`) لتغيير موقع النافذة بالنسبة للعنصر.
- يجب التأكد من أن النص المحدد (`self.text`) مناسب للعرض في نافذة التلميح، حيث يتم تحديد طول النص باستخدام `wraplength`.
***
### FunctionDef leave(self, event)
**leave**: وظيفة `leave` هي إغلاق وإزالة نافذة التلميح (tooltip) عند مغادرة المؤشر منطقة الـ widget المرتبط بها.

**parameters**: معاملات هذه الوظيفة.
· `event`: معامل اختياري يمثل الحدث الذي تم تشغيل الوظيفة بسببه (مثل حركة الماوس). القيمة الافتراضية له هي `None`.

**Code Description**: تقوم هذه الوظيفة بالتحقق من وجود نافذة تلميح (`tooltip_window`) مفتوحة. إذا كانت النافذة موجودة (`self.tooltip_window` ليس `None`)، يتم تدمير النافذة باستخدام الدالة `destroy()`، ثم يتم تعيين قيمة `self.tooltip_window` إلى `None` للإشارة إلى أن النافذة لم تعد موجودة.

ترتبط هذه الوظيفة بشكل وثيق مع وظيفة `__init__` للكائن `Tooltip`. عند إنشاء كائن `Tooltip`، يتم ربط حدث `Leave` (مغادرة المؤشر منطقة الـ widget) بهذه الوظيفة. بمعنى آخر، عندما يغادر المستخدم منطقة الـ widget المرتبط بالتلميح، يتم استدعاء هذه الوظيفة تلقائيًا لإغلاق نافذة التلميح.

**Note**: 
- يجب التأكد من أن `self.tooltip_window` يتم تعيينه بشكل صحيح في الوظائف الأخرى (مثل `enter`) لضمان عمل هذه الوظيفة بشكل صحيح.
- هذه الوظيفة تعتمد على مكتبة `tkinter` لإدارة النوافذ والأحداث، لذا يجب التأكد من أن الـ widget المرتبط يستخدم هذه المكتبة.
***
## ClassDef TextHandler
**TextHandler**: وظيفة TextHandler هي التعامل مع تسجيل الرسائل (logging) وعرضها في واجهة المستخدم الرسومية (GUI) باستخدام عنصر نصي (text widget).

**attributes**: السمات الخاصة بهذا الكلاس.
· `logger`: كائن الـ logger الذي يتم استخدامه لتسجيل الرسائل.
· `text_widget`: عنصر النص (text widget) في واجهة المستخدم الرسومية حيث سيتم عرض الرسائل المسجلة.

**Code Description**: وصف الكود.
يقوم هذا الكلاس TextHandler بتمديد (inherit) من الكلاس `logging.Handler` الموجود في مكتبة logging في بايثون. يتم استخدامه لتوجيه الرسائل المسجلة (log messages) إلى عنصر نصي (text widget) في واجهة المستخدم الرسومية (GUI). 

عند إنشاء كائن من هذا الكلاس، يتم تمرير كائن الـ logger وعنصر النص (text widget) كمعاملات. يتم تسجيل رسالة تفيد ببدء تهيئة الـ TextHandler باستخدام الـ logger الممرر. بعد ذلك، يتم استدعاء المُنشئ (constructor) للكلاس الأب `logging.Handler` باستخدام `super().__init__()`.

الوظيفة الرئيسية لهذا الكلاس هي `emit`، والتي يتم استدعاؤها تلقائيًا عند تسجيل رسالة. تقوم هذه الوظيفة بتنسيق الرسالة باستخدام الدالة `format`، ثم تقوم بتمكين عنصر النص (text widget) للتحرير باستخدام `config(state=tk.NORMAL)`. بعد ذلك، يتم إدراج الرسالة المنسقة في نهاية عنصر النص باستخدام `insert(tk.END, msg + "\n")`. يتم أيضًا ضمان ظهور أحدث رسالة في عنصر النص باستخدام `see(tk.END)`. أخيرًا، يتم تعطيل عنصر النص مرة أخرى باستخدام `config(state=tk.DISABLED)` لمنع المستخدم من التعديل المباشر على النص.

في المشروع، يتم استدعاء هذا الكلاس من خلال الدالة `add_textbox_log_handler` في الكلاس `YouTubeBulkUploaderGUI`. تقوم هذه الدالة بإنشاء كائن من TextHandler وإضافة تنسيق (Formatter) للرسائل المسجلة، ثم تضيف الـ TextHandler إلى الـ logger. هذا يسمح بعرض جميع الرسائل المسجلة في واجهة المستخدم الرسومية مباشرةً.

**Note**: ملاحظات حول استخدام الكود.
- يجب التأكد من أن عنصر النص (text widget) الممرر إلى TextHandler متوافق مع مكتبة tkinter وأنه تم تهيئته بشكل صحيح.
- يتم تعطيل عنصر النص بعد كل تحديث لمنع المستخدم من التعديل المباشر على النص، مما يضمن أن النص يبقى للقراءة فقط.
### FunctionDef __init__(self, logger, text_widget)
**__init__**: وظيفة `__init__` هي تهيئة كائن `TextHandler` وتعيين المتغيرات اللازمة له.

**parameters**: معاملات هذه الوظيفة.
· `logger`: كائن `logger` يستخدم لتسجيل الأحداث والرسائل التصحيحية.
· `text_widget`: كائن `text_widget` الذي سيتم ربطه بـ `TextHandler` لعرض النصوص.

**Code Description**: 
تقوم هذه الوظيفة بتهيئة كائن `TextHandler` من خلال تعيين المتغيرات الأساسية التي سيستخدمها الكائن. أولاً، يتم تعيين كائن `logger` الذي تم تمريره كمعامل إلى المتغير `self.logger`. بعد ذلك، يتم تسجيل رسالة تصحيحية (debug) باستخدام `logger` للإشارة إلى أن عملية التهيئة قد بدأت. ثم يتم استدعاء الوظيفة `__init__` للفئة الأم (superclass) باستخدام `super().__init__()` لضمان تنفيذ أي تهيئة مطلوبة من الفئة الأم. أخيرًا، يتم تعيين كائن `text_widget` الذي تم تمريره كمعامل إلى المتغير `self.text_widget`، والذي سيتم استخدامه لاحقًا لعرض النصوص.

**Note**: 
- يجب التأكد من أن كائن `logger` الممرر إلى الوظيفة يدعم وظيفة `debug` لتسجيل الرسائل التصحيحية.
- كائن `text_widget` يجب أن يكون متوافقًا مع الوظائف التي سيتم استخدامها لاحقًا في `TextHandler` لعرض النصوص.
***
### FunctionDef emit(self, record)
**emit**: وظيفة emit هي إدراج رسالة مسجلة في عنصر واجهة المستخدم النصي (text widget) وتحديثه لعرض الرسالة الجديدة.

**parameters**: معاملات هذه الوظيفة.
· record: يمثل السجل (record) الذي يحتوي على الرسالة المراد إدراجها في عنصر النص. يتم تنسيق هذا السجل لاستخراج الرسالة النهائية.

**Code Description**: 
تقوم هذه الوظيفة بإدراج رسالة في عنصر النص (text widget) الموجود في واجهة المستخدم. أولاً، يتم تنسيق السجل (record) باستخدام الدالة `format` لاستخراج الرسالة النهائية (msg). بعد ذلك، يتم تفعيل عنصر النص للتحرير عن طريق تعيين حالته إلى `NORMAL` باستخدام `self.text_widget.config(state=tk.NORMAL)`. يتم بعد ذلك إدراج الرسالة في نهاية عنصر النص باستخدام `self.text_widget.insert(tk.END, msg + "\n")`، حيث يتم إضافة سطر جديد بعد الرسالة. 

لضمان أن الرسالة الجديدة مرئية للمستخدم، يتم تمرير العرض إلى نهاية النص باستخدام `self.text_widget.see(tk.END)`. أخيرًا، يتم تعطيل عنصر النص مرة أخرى لمنع التحرير اليدوي من قبل المستخدم باستخدام `self.text_widget.config(state=tk.DISABLED)`.

**Note**: 
- يجب أن يكون عنصر النص (text widget) موجودًا ومهيأ بشكل صحيح قبل استدعاء هذه الوظيفة.
- هذه الوظيفة تعمل بشكل مثالي مع سجلات التسجيل (logging records) التي يتم تنسيقها مسبقًا.
- يتم تعطيل عنصر النص بعد كل تحديث لضمان أن المستخدم لا يمكنه تعديل النص يدويًا.
***
## ClassDef DualLogger
**DualLogger**: وظيفة DualLogger هي تسجيل الرسائل في نفس الوقت إلى كل من الملف وحدة التحكم (console). يتم استخدامها لتسجيل الرسائل في واجهة المستخدم الرسومية (GUI) وفي ملف في نفس الوقت.

**attributes**: السمات الخاصة بهذا الكلاس.
· `_lock`: عبارة عن قفل (lock) على مستوى الكلاس يتم مشاركته بين جميع النسخ (instances) من الكلاس. يتم استخدامه لضمان أن عملية الكتابة إلى الملف وحدة التحكم تتم بشكل آمن في البيئات متعددة الخيوط (multi-threaded environments).
· `file`: يمثل الملف الذي يتم تسجيل الرسائل فيه. يتم فتحه في وضع الإلحاق (append mode) حتى لا يتم الكتابة فوق المحتوى الحالي للملف.
· `stream`: يمثل وحدة التحكم (console) أو أي تيار (stream) آخر يتم تسجيل الرسائل إليه.

**Code Description**: وصف تفصيلي للكلاس.
تم تصميم الكلاس `DualLogger` لتسهيل عملية تسجيل الرسائل في نفس الوقت إلى كل من الملف وحدة التحكم. يتم استخدام هذا الكلاس بشكل رئيسي في مشروع YouTube Bulk Uploader لتسجيل الرسائل في واجهة المستخدم الرسومية وفي ملف سجل (log file) في نفس الوقت. 

عند إنشاء نسخة (instance) من الكلاس، يتم تمرير مسار الملف (`file_path`) ووحدة التحكم (`stream`) كمعاملات. يتم فتح الملف في وضع الإلحاق، وإذا فشلت عملية الفتح، يتم طباعة رسالة خطأ وتعيين `self.file` إلى `None`. 

الوظيفة `write` هي المسؤولة عن كتابة الرسالة إلى كل من الملف وحدة التحكم. يتم استخدام القفل (`_lock`) لضمان أن عملية الكتابة تتم بشكل آمن في البيئات متعددة الخيوط. إذا كان الملف (`self.file`) أو وحدة التحكم (`self.stream`) متاحًا، يتم كتابة الرسالة إليهما. بعد ذلك، يتم استدعاء الوظيفة `flush` لضمان أن الرسالة يتم كتابتها على الفور.

الوظيفة `flush` تقوم بتفريغ (flush) البيانات من الملف ووحدة التحكم لضمان أن جميع البيانات المرسلة يتم كتابتها على الفور.

في المشروع، يتم استخدام `DualLogger` في الوظيفة `main` لتوجيه `sys.stdout` و `sys.stderr` إلى نسختين من `DualLogger`. هذا يسمح بتسجيل جميع الرسائل التي يتم إرسالها إلى `stdout` و `stderr` في نفس الوقت إلى الملف وحدة التحكم. يتم استخدام هذا الأسلوب لتسهيل عملية تصحيح الأخطاء (debugging) وتتبع الأحداث في التطبيق.

**Note**: ملاحظات حول استخدام الكود.
1. يجب التأكد من أن المسار الممرر إلى `file_path` صالح ويمكن الوصول إليه، وإلا سيتم طباعة رسالة خطأ ولن يتم تسجيل الرسائل في الملف.
2. يتم استخدام القفل (`_lock`) لضمان أن عملية الكتابة تتم بشكل آمن في البيئات متعددة الخيوط، لذلك يجب عدم تعديله أو إزالته إلا إذا كنت متأكدًا من أن البيئة ليست متعددة الخيوط.
3. يمكن استخدام عدة نسخ من `DualLogger` تشير إلى نفس الملف دون أن تقوم بإعادة الكتابة فوق بعضها البعض، وذلك لأن الملف يتم فتحه في وضع الإلحاق.
### FunctionDef __init__(self, file_path, stream)
Doc is waiting to be generated...
***
### FunctionDef write(self, message)
**write**: وظيفة `write` هي كتابة رسالة (`message`) إلى كل من الملف (`file`) والتدفق (`stream`) إذا كانا متاحين، مع ضمان إرسال الرسالة على الفور.

**parameters**: تحتوي هذه الدالة على معامل واحد:
· `message`: الرسالة التي سيتم كتابتها في الملف والتدفق.

**Code Description**: تقوم دالة `write` بكتابة الرسالة (`message`) إلى كل من الملف (`self.file`) والتدفق (`self.stream`) إذا كانا موجودين. يتم تنفيذ هذه العملية بشكل آمن في بيئة متعددة الخيوط (multi-threaded) باستخدام قفل (`self._lock`) لضمان أن عملية الكتابة تتم بشكل متسلسل ومن دون تداخل بين الخيوط. 

بعد كتابة الرسالة، يتم استدعاء دالة `flush` مباشرة لضمان إفراغ البيانات المخزنة في الذاكرة المؤقتة إلى الوجهة النهائية (الملف أو التدفق) على الفور. هذا يضمن أن الرسالة لا تبقى في الذاكرة المؤقتة لفترة طويلة، مما يعزز من فعالية النظام في التعامل مع البيانات في الوقت الفعلي.

**Note**: يجب التأكد من أن كل من `self.file` و `self.stream` تم تهيئتهما بشكل صحيح قبل استدعاء هذه الدالة، وإلا لن تتم كتابة أي بيانات. بالإضافة إلى ذلك، يتم استخدام هذه الدالة في سياق متعدد الخيوط، حيث يتم ضمان تنفيذها بشكل آمن باستخدام قفل (`lock`).
***
### FunctionDef flush(self)
**flush**: وظيفة `flush` هي التأكد من إفراغ البيانات المخزنة في الذاكرة المؤقتة (buffer) إلى الوجهة النهائية، سواء كانت ملفًا أو تدفقًا (stream).

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters).

**Code Description**: تقوم دالة `flush` بتنفيذ عملية إفراغ البيانات من الذاكرة المؤقتة إلى الوجهة النهائية. يتم ذلك من خلال التحقق أولاً مما إذا كان الملف (`self.file`) موجودًا، وفي حالة وجوده، يتم استدعاء دالة `flush` الخاصة به لضمان كتابة البيانات المخزنة في الذاكرة المؤقتة إلى الملف. بعد ذلك، يتم التحقق مما إذا كان التدفق (`self.stream`) موجودًا، وفي حالة وجوده، يتم استدعاء دالة `flush` الخاصة به أيضًا لضمان إفراغ البيانات إلى التدفق.

في سياق المشروع، يتم استدعاء هذه الدالة من خلال دالة `write` في الكائن `DualLogger`. عندما يتم كتابة رسالة (`message`) في كل من الملف والتدفق، يتم استدعاء `flush` مباشرة بعد عملية الكتابة لضمان أن الرسالة قد تم إرسالها على الفور دون تأخير. هذا يضمن أن البيانات لا تبقى في الذاكرة المؤقتة لفترة طويلة، مما يعزز من فعالية النظام في التعامل مع البيانات في الوقت الفعلي.

**Note**: يجب التأكد من أن كل من `self.file` و `self.stream` تم تهيئتهما بشكل صحيح قبل استدعاء هذه الدالة، وإلا لن يتم إفراغ أي بيانات. بالإضافة إلى ذلك، يتم استخدام هذه الدالة في سياق متعدد الخيوط (multi-threaded)، حيث يتم ضمان تنفيذها بشكل آمن باستخدام قفل (`lock`) في دالة `write`.
***
## FunctionDef main
**main**: وظيفة main هي تهيئة وتشغيل واجهة المستخدم الرسومية (GUI) لتطبيق تحميل مقاطع الفيديو بشكل جماعي إلى YouTube.

**parameters**: لا تحتوي هذه الدالة على أي معاملات (parameters).

**Code Description**: 
دالة `main` هي نقطة البداية لتشغيل تطبيق YouTube Bulk Uploader. تقوم هذه الدالة بإعداد البيئة اللازمة لتشغيل الواجهة الرسومية، بما في ذلك تحديد مسار ملف السجل (log file) بناءً على ما إذا كان التطبيق يعمل من خلال PyInstaller أم لا. إذا كان التطبيق يعمل من خلال PyInstaller، يتم تحديد مسار ملف السجل في دليل المستخدم الرئيسي (`~`). وإلا، يتم تحديد المسار في الدليل الحالي.

بعد ذلك، تقوم الدالة بتوجيه `sys.stdout` و `sys.stderr` إلى كائن `DualLogger`، مما يسمح بتسجيل الرسائل في نفس الوقت إلى كل من الملف وحدة التحكم (console). يتم أيضًا تهيئة كائن `logger` لتسجيل الأحداث والرسائل أثناء تشغيل التطبيق، مع تحديد مستوى التسجيل (log level) إلى `DEBUG` لضمان تسجيل جميع الأحداث.

بعد ذلك، يتم إنشاء كائن `Tkinter` الرئيسي (`gui_root`) الذي يمثل النافذة الرئيسية للواجهة الرسومية. يتم بعد ذلك إنشاء كائن من فئة `YouTubeBulkUploaderGUI` وتمرير الكائنات الضرورية مثل `gui_root` و `logger` و `bundle_dir` و `running_in_pyinstaller`. يتم بعد ذلك تشغيل الحلقة الرئيسية للواجهة الرسومية باستخدام `gui_root.mainloop()`.

في حالة حدوث أي استثناء (exception) أثناء تشغيل الواجهة الرسومية، يتم تسجيل الخطأ وعرض رسالة خطأ للمستخدم باستخدام `messagebox.showerror`.

**Note**: 
- يجب التأكد من أن مسار ملف السجل (`log_filepath`) صالح ويمكن الوصول إليه، حيث يتم تسجيل جميع الأحداث والرسائل فيه.
- يتم استخدام `DualLogger` لتسجيل الرسائل في نفس الوقت إلى الملف وحدة التحكم، مما يسهل عملية تصحيح الأخطاء وتتبع الأحداث في التطبيق.
- يتم استخدام `YouTubeBulkUploaderGUI` لإدارة الواجهة الرسومية وتفاعلات المستخدم مع التطبيق.
