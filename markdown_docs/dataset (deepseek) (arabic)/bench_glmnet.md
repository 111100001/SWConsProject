<div dir="rtl">

## FunctionDef rmse(a, b)
**rmse**: وظيفة `rmse` هي حساب جذر متوسط مربعات الخطأ (Root Mean Squared Error) بين قيمتين.  
**parameters**: معاملات هذه الوظيفة.  
· `a`: مصفوفة أو قيم فعلية (حقيقية).  
· `b`: مصفوفة أو قيم متوقعة.  

**Code Description**:  
تقوم هذه الوظيفة بحساب جذر متوسط مربعات الخطأ (RMSE) بين قيمتين `a` و`b`. يتم ذلك عن طريق الخطوات التالية:  
1. حساب الفرق بين القيم الفعلية (`a`) والقيم المتوقعة (`b`) باستخدام العملية `(a - b)`.  
2. رفع الفروق إلى القوة الثانية باستخدام `** 2` للحصول على مربعات الأخطاء.  
3. حساب متوسط هذه المربعات باستخدام `np.mean`.  
4. أخيرًا، حساب الجذر التربيعي للمتوسط باستخدام `np.sqrt` للحصول على قيمة RMSE.  

تُستخدم هذه الوظيفة في مشروع `bench_glmnet.py` ضمن وظيفة `bench` لتقييم أداء نموذج التعلم الآلي. حيث يتم حساب RMSE بين القيم الفعلية (`Y_test`) والقيم المتوقعة (`clf.predict(X_test)`) التي يتم توليدها بواسطة النموذج. يتم عرض النتيجة باستخدام `print` لتوفير مقياس دقة النموذج.  

**Note**:  
- يجب أن تكون المصفوفات `a` و`b` بنفس الأبعاد حتى تعمل الوظيفة بشكل صحيح.  
- القيم الناتجة تكون دائمًا غير سالبة لأنها تعتمد على مربعات الأخطاء.  

**Output Example**:  
إذا كانت القيم الفعلية `a = [3, 5, 7]` والقيم المتوقعة `b = [2.5, 4.8, 7.2]`، فإن نتيجة `rmse(a, b)` ستكون قريبة من `0.374`.
## FunctionDef bench(factory, X, Y, X_test, Y_test, ref_coef)
**bench**: وظيفة `bench` تقوم بتقييم أداء نموذج تعلم آلي من خلال حساب الوقت المستغرق للتدريب، جذر متوسط مربعات الخطأ (RMSE)، ومتوسط الفرق المطلق بين معاملات النموذج المرجعي والمعاملات المتوقعة.

**parameters**: معاملات هذه الوظيفة.  
· `factory`: دالة أو كائن يستخدم لإنشاء النموذج (مثل `LinearRegression` أو `Ridge`).  
· `X`: مصفوفة تحتوي على بيانات التدريب (الميزات).  
· `Y`: مصفوفة تحتوي على القيم المستهدفة (التسميات) لبيانات التدريب.  
· `X_test`: مصفوفة تحتوي على بيانات الاختبار (الميزات).  
· `Y_test`: مصفوفة تحتوي على القيم المستهدفة (التسميات) لبيانات الاختبار.  
· `ref_coef`: مصفوفة تحتوي على معاملات النموذج المرجعي المستخدمة للمقارنة.  

**Code Description**:  
تقوم هذه الوظيفة بتنفيذ الخطوات التالية:  
1. تنظيف الذاكرة باستخدام `gc.collect()` لضمان عدم وجود بيانات غير مستخدمة تعيق الأداء.  
2. بدء قياس الوقت باستخدام `time()` لتسجيل الوقت الحالي.  
3. إنشاء النموذج باستخدام الدالة `factory` مع معلمة `alpha` محددة، ثم تدريبه على بيانات التدريب (`X` و`Y`) باستخدام `fit`.  
4. حساب الوقت المستغرق للتدريب عن طريق طرح الوقت الحالي من الوقت المسجل في البداية.  
5. طباعة الوقت المستغرق للتدريب باستخدام `print`.  
6. حساب جذر متوسط مربعات الخطأ (RMSE) بين القيم الفعلية (`Y_test`) والقيم المتوقعة (`clf.predict(X_test)`) باستخدام وظيفة `rmse`، ثم طباعة النتيجة.  
7. حساب متوسط الفرق المطلق بين معاملات النموذج المرجعي (`ref_coef`) والمعاملات المتوقعة (`clf.coef_.ravel()`) باستخدام `abs` و`mean`، ثم طباعة النتيجة.  
8. إرجاع الوقت المستغرق للتدريب كقيمة مخرجة.  

تُستخدم هذه الوظيفة لتقييم أداء النماذج في مشاريع التعلم الآلي، حيث توفر مقاييس مثل الوقت المستغرق للتدريب، دقة النموذج (RMSE)، ومدى قرب معاملات النموذج من المعاملات المرجعية.  

**Note**:  
- يجب أن تكون المصفوفات `X` و`Y` و`X_test` و`Y_test` متوافقة في الأبعاد حتى تعمل الوظيفة بشكل صحيح.  
- المعلمة `alpha` يجب أن تكون محددة بشكل صحيح لضمان إنشاء النموذج بشكل صحيح.  
- القيمة المرجعية `ref_coef` يجب أن تكون متاحة للمقارنة.  

**Output Example**:  
إذا كان الوقت المستغرق للتدريب هو `0.123` ثانية، وكانت قيمة RMSE هي `0.456`، وكان متوسط الفرق المطلق بين المعاملات هو `0.789`، فإن الناتج سيكون:  
```
duration: 0.123s  
rmse: 0.456  
mean coef abs diff: 0.789  
```  
وستكون القيمة المُرجعَة هي `0.123`.
</div>
