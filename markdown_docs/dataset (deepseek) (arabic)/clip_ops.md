## FunctionDef clip_by_value(t, clip_value_min, clip_value_max, name)
**clip_by_value**: وظيفة `clip_by_value` هي قص قيم الموتر (tensor) إلى قيمة دنيا وقيمة قصوى محددة.

**parameters**: معاملات هذه الوظيفة.
· `t`: موتر (Tensor) أو `IndexedSlices` يحتوي على القيم التي سيتم قصها.
· `clip_value_min`: القيمة الدنيا التي سيتم قص القيم إليها. يمكن أن تكون قيمة عددية (scalar) أو موتر قابل للبث (broadcastable) إلى شكل الموتر `t`.
· `clip_value_max`: القيمة القصوى التي سيتم قص القيم إليها. يمكن أن تكون قيمة عددية (scalar) أو موتر قابل للبث (broadcastable) إلى شكل الموتر `t`.
· `name`: اسم اختياري للعملية.

**Code Description**: تقوم هذه الوظيفة بقص قيم الموتر `t` بحيث تكون جميع القيم ضمن النطاق المحدد بواسطة `clip_value_min` و`clip_value_max`. أي قيمة أقل من `clip_value_min` يتم تعيينها إلى `clip_value_min`، وأي قيمة أكبر من `clip_value_max` يتم تعيينها إلى `clip_value_max`. 

يتم أولاً تحويل الموتر `t` إلى موتر باستخدام `ops.convert_to_tensor` إذا كان من النوع `IndexedSlices`. ثم يتم استخدام الدالة `math_ops.minimum` لضمان أن جميع القيم أقل من أو تساوي `clip_value_max`. بعد ذلك، يتم استخدام الدالة `math_ops.maximum` لضمان أن جميع القيم أكبر من أو تساوي `clip_value_min`. يتم التحقق من توافق الأشكال (shape compatibility) في كل خطوة لتجنب البث غير المقصود (unintentional broadcasting).

إذا كان الموتر المدخل من النوع `IndexedSlices`، يتم إعادة بناء الموتر الناتج ككائن من النوع `IndexedSlices` مع الحفاظ على المؤشرات (indices) والشكل الكثيف (dense shape).

**Note**: 
1. يجب أن تكون `clip_value_min` أصغر من أو تساوي `clip_value_max` للحصول على نتائج صحيحة.
2. إذا كان نوع البيانات (dtype) للموتر المدخل هو `int32` ونوع بيانات `clip_value_min` أو `clip_value_max` هو `float32`، سيتم إرجاع خطأ `TypeError`.
3. إذا كانت قيم `clip_value_min` أو `clip_value_max` ستؤدي إلى بث (broadcasting) يغير حجم الموتر الناتج بشكل غير متوافق مع المدخل، سيتم إرجاع خطأ `InvalidArgumentError`.

**Output Example**: 
```python
import tensorflow as tf

t = tf.constant([[-10., -1., 0.], [0., 2., 10.]])
t2 = tf.clip_by_value(t, clip_value_min=-1, clip_value_max=1)
print(t2.numpy())
```
الإخراج المتوقع:
```
array([[-1., -1.,  0.],
       [ 0.,  1.,  1.]], dtype=float32)
```
## FunctionDef _clip_by_value_grad(op, grad)
**_clip_by_value_grad**: وظيفة `_clip_by_value_grad` هي حساب التدرج (gradient) لعملية `clip_by_value`.

**parameters**: معاملات هذه الوظيفة.
· `op`: كائن العملية (operation) الذي يحتوي على المدخلات والمخرجات المرتبطة بعملية `clip_by_value`.
· `grad`: التدرج الذي يتم تمريره من الطبقات اللاحقة في الشبكة العصبية.

**Code Description**: 
تقوم هذه الوظيفة بحساب التدرج لعملية `clip_by_value`، والتي تقوم بقيمة المدخلات بين حدين معينين (حد أدنى وحد أقصى). يتم ذلك عن طريق الخطوات التالية:

1. يتم استخراج المدخلات الأصلية (`x`، `y`، `z`) من كائن العملية `op`. حيث `x` هو المدخل الأساسي، و`y` هو الحد الأدنى، و`z` هو الحد الأقصى.
2. يتم تحديد نوع البيانات للتدرج (`gdtype`) وحساب الأشكال (`shape`) للمدخلات والتدرج.
3. يتم إنشاء مصفوفة من الأصفار بنفس شكل التدرج (`zeros`).
4. يتم إنشاء أقنعة (`masks`) لتحديد الأماكن التي تكون فيها قيم `x` أقل من `y` (`xymask`) أو أكبر من `z` (`xzmask`).
5. يتم حساب التدرج بالنسبة لـ `x` (`xgrad`) عن طريق تطبيق الأقنعة على التدرج الممرر. إذا كانت القيمة خارج الحدود، يتم تعيين التدرج إلى صفر.
6. يتم حساب التدرج بالنسبة لـ `y` (`ygrad`) و`z` (`zgrad`) بنفس الطريقة، ولكن مع تطبيق الأقنعة المناسبة.
7. يتم تقليل (`reduce_sum`) وإعادة تشكيل (`reshape`) التدرجات الخاصة بـ `y` و`z` لضمان تطابق الأشكال مع المدخلات الأصلية.
8. يتم إرجاع التدرجات المحسوبة لـ `x`، `y`، و`z`.

**Note**: 
- هذه الوظيفة تستخدم عادةً في الشبكات العصبية لحساب التدرجات أثناء عملية التدريب (backpropagation).
- يجب أن تكون المدخلات (`x`، `y`، `z`) متوافقة في الشكل أو قابلة للبث (`broadcastable`).

**Output Example**: 
على سبيل المثال، إذا كانت المدخلات والتدرجات كالتالي:
- `x` = [1, 2, 3]
- `y` = [0, 1, 2]
- `z` = [2, 3, 4]
- `grad` = [0.5, 0.5, 0.5]

فإن المخرجات ستكون:
- `xgrad` = [0.5, 0.5, 0]
- `gy` = [0.5, 0, 0]
- `gz` = [0, 0, 0.5]
## FunctionDef clip_by_norm(t, clip_norm, axes, name)
**clip_by_norm**: وظيفة `clip_by_norm` هي قص قيم الموتر (tensor) إلى الحد الأقصى للقاعدة الإقليدية (L2-norm).  
**parameters**: معاملات هذه الوظيفة.  
· `t`: موتر (`Tensor`) أو `IndexedSlices` من النوع العائم (floating point).  
· `clip_norm`: موتر عددي (0-D) من النوع العائم وقيمته أكبر من الصفر، يمثل الحد الأقصى للقيمة التي سيتم القص إليها.  
· `axes`: موتر من النوع `int32` يحتوي على الأبعاد التي سيتم استخدامها لحساب القاعدة الإقليدية. إذا كان `None` (القيمة الافتراضية)، يتم استخدام جميع الأبعاد.  
· `name`: اسم اختياري للعملية.  

**Code Description**:  
تقوم هذه الوظيفة بقص قيم الموتر `t` بحيث تكون القاعدة الإقليدية (L2-norm) له أقل من أو تساوي القيمة المحددة `clip_norm`. إذا كانت القاعدة الإقليدية للموتر `t` بالفعل أقل من أو تساوي `clip_norm`، فلن يتم تعديل الموتر. إذا كانت القاعدة الإقليدية أكبر من `clip_norm`، فإن الوظيفة تقوم بإرجاع موتر بنفس نوع وشكل الموتر الأصلي `t` مع تعديل قيمه وفقًا للصيغة التالية:  
`t * clip_norm / l2norm(t)`  
حيث تكون القاعدة الإقليدية للموتر الناتج مساوية لـ `clip_norm`.  

على سبيل المثال، إذا كان `t` مصفوفة وتم تحديد `axes == [1]`، فإن كل صف في الموتر الناتج سيكون له قاعدة إقليدية أقل من أو تساوي `clip_norm`. إذا تم تحديد `axes == [0]`، فسيتم قص كل عمود في الموتر الناتج.  

تستخدم هذه الوظيفة عادةً لقص التدرجات (gradients) قبل تطبيقها باستخدام مُحسّن (optimizer) في تدريب النماذج.  

**Note**:  
- يجب أن يكون `clip_norm` موترًا عدديًا (0-D) وقيمته أكبر من الصفر.  
- يجب أن يكون نوع بيانات الموتر المدخل (`t`) عائمًا (floating point) أو معقدًا (complex).  
- إذا تم تمرير `IndexedSlices` كمدخل، فإن الوظيفة تقوم بإرجاع `IndexedSlices` بقيم مقصوصة.  

**Output Example**:  
```python
import tensorflow as tf

some_nums = tf.constant([[1, 2, 3, 4, 5]], dtype=tf.float32)
clipped_nums = tf.clip_by_norm(some_nums, 2.0)
print(clipped_nums.numpy())
```
الإخراج المتوقع:  
```
array([[0.26967996, 0.5393599 , 0.80903983, 1.0787199 , 1.3483998 ]],
      dtype=float32)
```
## FunctionDef global_norm(t_list, name)
**global_norm**: وظيفة `global_norm` هي حساب القاعدة العالمية (global norm) لعناصر متعددة من الموترات (tensors) في قائمة أو مجموعة.

**parameters**: معاملات هذه الوظيفة.
· `t_list`: قائمة أو مجموعة تحتوي على موترات (tensors) من نوع `Tensors` أو `IndexedSlices` أو `None`. يتم تجاهل أي عناصر من النوع `None`.
· `name`: اسم اختياري للعملية (operation). إذا لم يتم تحديده، سيتم تعيين اسم افتراضي.

**Code Description**: 
تقوم هذه الوظيفة بحساب القاعدة العالمية (global norm) لعناصر متعددة من الموترات (tensors) المقدمة في القائمة `t_list`. القاعدة العالمية تُحسب باستخدام الصيغة التالية:

`global_norm = sqrt(sum([l2norm(t)**2 for t in t_list]))`

حيث يتم حساب القاعدة L2 (l2norm) لكل موتر في القائمة، ثم يتم جمع مربعات هذه القواعد وأخذ الجذر التربيعي للناتج للحصول على القاعدة العالمية.

في البداية، يتم التحقق من أن `t_list` هو تسلسل (sequence) وليس نصًا (string). إذا لم يكن كذلك، يتم إرجاع خطأ من النوع `TypeError`. بعد ذلك، يتم تحويل `t_list` إلى قائمة إذا لم تكن كذلك بالفعل.

ثم يتم تحويل كل عنصر في القائمة إلى موتر (tensor) إذا كان من النوع `IndexedSlices`، أو يتم استخدامه كما هو إذا كان موترًا بالفعل. يتم تجاهل العناصر التي تكون `None`.

بعد ذلك، يتم حساب نصف مربع القاعدة (half squared norm) لكل موتر باستخدام دالة `l2_loss`، ويتم جمع هذه القيم للحصول على نصف مربع القاعدة الكلي. أخيرًا، يتم حساب القاعدة العالمية بأخذ الجذر التربيعي للناتج مضروبًا في 2.

تُستخدم هذه الوظيفة بشكل أساسي في عملية `clip_by_global_norm`، حيث يتم حساب القاعدة العالمية للموترات قبل تطبيق عملية القص (clipping) بناءً على هذه القاعدة.

**Note**: 
- يجب أن تكون `t_list` قائمة أو مجموعة تحتوي على موترات أو `IndexedSlices`. إذا كانت تحتوي على أنواع أخرى، سيتم إرجاع خطأ.
- يتم تجاهل أي عناصر من النوع `None` في القائمة.

**Output Example**: 
على سبيل المثال، إذا كانت القائمة `t_list` تحتوي على ثلاثة موترات بقواعد L2 تساوي 3، 4، و5 على التوالي، فإن القاعدة العالمية التي ستعيدها الوظيفة ستكون:

`global_norm = sqrt(3^2 + 4^2 + 5^2) = sqrt(9 + 16 + 25) = sqrt(50) ≈ 7.071`

وستكون القيمة المُرجعة موترًا عدديًا (scalar tensor) بقيمة تقريبية تساوي 7.071.
## FunctionDef clip_by_global_norm(t_list, clip_norm, use_norm, name)
**clip_by_global_norm**: وظيفة `clip_by_global_norm` هي قص قيم متعددة من الموترات (tensors) بناءً على نسبة مجموع قواعدها (norms).

**parameters**: معاملات هذه الوظيفة.
· `t_list`: قائمة أو مجموعة تحتوي على موترات (tensors) من نوع `Tensors` أو `IndexedSlices` أو `None`. يتم تجاهل أي عناصر من النوع `None`.
· `clip_norm`: موتر عددي (scalar tensor) من النوع `float` وقيمته أكبر من الصفر. يمثل نسبة القص (clipping ratio).
· `use_norm`: موتر عددي (scalar tensor) من النوع `float` (اختياري). يمثل القاعدة العالمية (global norm) التي سيتم استخدامها. إذا لم يتم توفيره، سيتم حساب القاعدة العالمية باستخدام دالة `global_norm`.
· `name`: اسم اختياري للعملية (operation). إذا لم يتم تحديده، سيتم تعيين اسم افتراضي.

**Code Description**: 
تقوم هذه الوظيفة بقص قيم الموترات في القائمة `t_list` بناءً على نسبة القص `clip_norm` والقاعدة العالمية `global_norm`. يتم حساب القاعدة العالمية باستخدام الصيغة التالية:

`global_norm = sqrt(sum([l2norm(t)**2 for t in t_list]))`

إذا كانت القاعدة العالمية `global_norm` أكبر من `clip_norm`، يتم تقليل قيم جميع الموترات في القائمة بنسبة `clip_norm / global_norm`. إذا كانت `global_norm` أقل من أو تساوي `clip_norm`، تبقى قيم الموترات كما هي دون تغيير. في حالة كانت القاعدة العالمية تساوي ما لا نهاية (`infinity`)، يتم تعيين قيم جميع الموترات إلى `NaN` للإشارة إلى حدوث خطأ.

يتم تجاهل أي عناصر في القائمة `t_list` تكون من النوع `None`. إذا تم توفير `use_norm`، يتم استخدامه مباشرةً كقاعدة عالمية بدلاً من حسابها.

تستخدم هذه الوظيفة دالة `global_norm` لحساب القاعدة العالمية إذا لم يتم توفير `use_norm`. بعد ذلك، يتم حساب عامل القص (`scale`) بناءً على نسبة `clip_norm` إلى `global_norm`. يتم تطبيق هذا العامل على كل موتر في القائمة للحصول على القيم المقصوصة.

**Note**: 
- يجب أن تكون `t_list` قائمة أو مجموعة تحتوي على موترات أو `IndexedSlices`. إذا كانت تحتوي على أنواع أخرى، سيتم إرجاع خطأ.
- يتم تجاهل أي عناصر من النوع `None` في القائمة.
- هذه الوظيفة أبطأ من `clip_by_norm` لأنها تتطلب أن تكون جميع المعاملات جاهزة قبل تنفيذ عملية القص.

**Output Example**: 
على سبيل المثال، إذا كانت القائمة `t_list` تحتوي على ثلاثة موترات بقيم `[2.0, 3.0, 4.0]`، وكانت `clip_norm` تساوي `5.0`، والقاعدة العالمية `global_norm` تساوي `6.0`، فإن القيم المقصوصة التي ستعيدها الوظيفة ستكون:

`list_clipped = [2.0 * (5.0 / 6.0), 3.0 * (5.0 / 6.0), 4.0 * (5.0 / 6.0)] = [1.666, 2.5, 3.333]`

وستكون القيمة المُرجعة للقاعدة العالمية `global_norm` هي `6.0`.
## FunctionDef clip_by_average_norm(t, clip_norm, name)
**clip_by_average_norm**: وظيفة `clip_by_average_norm` هي قص قيم الموتر (tensor) بحيث لا يتجاوز متوسط القاعدة الإقليدية (L2-norm) قيمة قص معينة.

**المعلمات**:
· `t`: موتر (Tensor) يتم قص قيمه.
· `clip_norm`: موتر عددي (scalar) من النوع 0-D وقيمته أكبر من الصفر. يمثل القيمة القصوى التي سيتم قص الموتر بناءً عليها.
· `name`: اسم اختياري للعملية (operation).

**وصف الكود**: تقوم هذه الوظيفة بقص قيم الموتر `t` بحيث يكون متوسط القاعدة الإقليدية (L2-norm) أقل من أو يساوي القيمة المحددة `clip_norm`. إذا كان متوسط القاعدة الإقليدية للموتر `t` بالفعل أقل من أو يساوي `clip_norm`، فإن الموتر لا يتم تعديله. أما إذا كان المتوسط أكبر من `clip_norm`، فإن الوظيفة تقوم بإرجاع موتر بنفس نوع وشكل الموتر الأصلي `t`، ولكن مع تعديل قيمه وفقًا للصيغة التالية:

`t * clip_norm / l2norm_avg(t)`

حيث `l2norm_avg(t)` هو متوسط القاعدة الإقليدية للموتر `t`. بعد التعديل، يصبح متوسط القاعدة الإقليدية للموتر الناتج مساويًا لـ `clip_norm`.

يتم استخدام هذه الوظيفة عادةً لقص التدرجات (gradients) قبل تطبيقها باستخدام مُحسّن (optimizer) في تدريب نماذج التعلم الآلي.

**ملاحظات**:
- يجب أن تكون قيمة `clip_norm` أكبر من الصفر.
- الوظيفة تعمل بشكل فعال مع الموترات ذات الأبعاد المختلفة.

**مثال للإخراج**: لنفترض أن لدينا موتر `t` بقيم `[3.0, 4.0]` وقيمة `clip_norm` تساوي `2.0`. بعد تطبيق الوظيفة، قد يكون الإخراج موترًا بقيم `[1.2, 1.6]` حيث يتم قص القيم بحيث يكون متوسط القاعدة الإقليدية للموتر الناتج مساويًا لـ `2.0`.

هذا الوصف يوضح بالتفصيل كيفية عمل الوظيفة وكيفية استخدامها في سياق تطبيقات التعلم الآلي.
